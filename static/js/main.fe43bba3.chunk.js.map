{"version":3,"sources":["Editor.js","toCml.js","sounds/決定、ボタン押下38.mp3","sounds/決定、ボタン押下44.mp3","serialPort.js","programBlock.js","useLocalStorage.js","settingsPanel/settingInfo.js","settingsPanel/settingsPanel.js","tanni-funcs.js","menu.js","image/popup-instruction.png","App.js","eng/programBlock_eng.js","eng/tanni-funcs_eng.js","eng/menu_eng.js","eng/App_eng.js","index.js"],"names":["Editor","props","className","onBeforeChange","editor","data","value","onChange","options","lineWrapping","lint","lineNumbers","theme","toCML","programData","loopData","isNyuryokuShingou","tkData","output","every_data_teigi","every_program_teigi","dousa_group","indexOf","toString","dousa_jikkou_of_group","dousa_row","dousa_jikkou_row_arr","dousa","length","dousa_jiku","cml_numbers","tanniValue","getPulseValue","push","alert","loop_start","loop_end","loop","join","valueArr","divideVar","parseFloat","tanni","includes","Math","round","str2ab","str","buf","ArrayBuffer","bufView","Uint16Array","i","strLen","charCodeAt","pressRun","cml","cmlChunkList","split","navigator","serial","requestPort","port","open","baudRate","writer","writable","getWriter","cmlChunk","write","releaseLock","close","stop","ProgramBlock","addRowRef","useRef","pgEmptyBox","useState","dousaNumArr","setDousaNumArr","trashInput","e","setProgramData","indexArr","target","parentNode","id","shift","tmp","trashJiku","currentTarget","index","jiku","splice","setJiku","tkTmp","setTkData","setLoopData","addRow","emptyRow","addJiku","kikou","susumiryou","gensoku","bunkai","moveRow","direction","dousaGroup","rowIndex","moveJiku","current_jiku","tmp_dousa","tmp_tk_item","showTypeData","isLoop","parentId","dousaType","dousaNum","setLoopInputObj","setInputBoxType","typeDataObj","setTypeDataObj","emptyBoxDragEnd","style","cursor","resizeLoop","mainItemIndex","forEach","isDirectionAvailable","rowLength","dousaBoxRef","pg_l_arr","main_grid","jiku_i","jiku_num","onClick","gridColumn","dousa_group_i","tmpLoop","trashGroup","dontPutEmp","dousa_row_i","loopCount","loopHeight","loopStyleHeight","z","dragArrows","loopId","height","map","dragArrow","trashLoop","onDragOver","currentDraggedCommand","preventDefault","emptyBoxLoopDragOver","onDragEnter","emptyBoxLoopDragEnter","onDragLeave","emptyBoxLoopDragLeave","onDrop","isMute","Audio","soundfile2","play","emptyBoxLoopDragDrop","ref","dousa_i","noValueArr","dousaId","jikuOfDousa","draggable","onDragStart","onDragEnd","onMouseEnter","setCurrentDraggedCommand","marginRight","emptyBoxDragOver","emptyBoxDragEnter","emptyBoxDragLeave","audio","draggedIndexArr","tmpDousaNumArr","emptyBoxDragDrop","trashRow","addGroupDragOver","querySelector","display","addGroupDragEnter","addGroupDragLeave","emptyGroup","addGroupDragDrop","gridTemplateColumns","dataToHTML","Button","variant","width","setCmlOutput","TypeDataInDousa","popupRef","jikuNum","closeTypeData","subTanni","dataFormat","ichigimeData","bangouRange","inputForm","incrementalIchigimeData","oshitukeData","incrementalOshitukeData","DousaInputBox","range","inputLine","DataInput","tanniArr","isAllNumber","current","querySelectorAll","input","isNaN","inputs","tanniSelectors","setTypeData","setValue","tanniState","setTanniState","required","placeholder","defaultValue","LoopInputBox","NumDropDown","currentNum","setCurrentNum","numItemRef","currentNumRef","selectItem","sameDataArr","isItemsShown","showItems","res","getNumItems","useLocalStorage","key","initialValue","prefixedKey","jsonValue","localStorage","getItem","JSON","parse","useEffect","setItem","stringify","SettingInfo","text","textBoxRef","classList","add","remove","setTimeout","contains","onMouseLeave","SettingsPanel","closePanel","settingsPanelData","SettingsPanelItem","item","WizardJiku","params","tannikannsannData","history","setInput","checkBoxRef","num","checked","changeInput","isChecked","type","name","htmlFor","jikuCheckBoxContainer","isCheckedArr","checkBox","setHistory","setWizardInput","goNext","WizardKikou","jikuMainNum","radioRef","WizardSusumiryou","mode","susumiryouText","susumiryouVar","PI","Number","EPSILON","kikouValue","goBack","WizardGensoku","input1","setInput1","input2","setInput2","selectorRef","opacity","readOnly","handleToggle","WizardBunkai","bunkaiText","bunkaiVar","defaultItem","itemArr","n","digits","negative","undefined","multiplicator","pow","toFixed","roundTo","setTannikannsannData","goOK","Dropdown","selectedItem","setSelectedItem","dropdownItems","selectedItemRef","clickItem","innerText","downloadFile","filename","file","Blob","window","msSaveOrOpenBlob","a","document","createElement","url","URL","createObjectURL","href","download","body","appendChild","click","removeChild","revokeObjectURL","TopMenu","topMenuRef","muteIconRef","handleFileSave","obj","hide","muteIcon","expSave","expImp","expTanni","accept","reader","FileReader","onload","result","readAsText","files","handleFileImport","layerRef","application","setApplication","setTanniValue","closeTanni","setIsMute","to","Tannikannsann","WizardController","wizardInput","App","title","cmlOutput","setIsNyuryokuShingou","initialTannikannsannData","Array","loopInputObj","inputBoxType","typeDataRef","loopInputRef","expCopy","expCopyDone","commandSelectorRef","instructionPopupRef","commandDragStart","soundfile1","commandHover","handleFileExport","DataInputBox","isInitial","PopUpOfInstruction","src","instructionImg","alt","clipboard","writeText","ProgramBlockEng","dousaName","TypeDataInDousaEng","LoopInputBoxEng","WizardJikuEng","WizardKikouEng","WizardSusumiryouEng","WizardGensokuEng","WizardBunkaiEng","DropdownEng","TopMenuEng","AppEng","AppWrapper","basename","path","element","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.fe43bba3.chunk.js","sourcesContent":["import React from 'react'\r\nimport 'codemirror/lib/codemirror.css'\r\nimport 'codemirror/theme/material.css'\r\nimport { Controlled as ControlledEditor } from 'react-codemirror2'\r\n\r\nexport const Editor = (props) => {\r\n\r\n    const handleChange = (editor, data, value) => {\r\n        props.onChange(value)\r\n    }\r\n\r\n    return(\r\n        <div className=\"cml-editor-container\">\r\n            <ControlledEditor \r\n                onBeforeChange={handleChange}\r\n                value={props.value}\r\n                className=\"cml-editor\"\r\n                options={{\r\n                    lineWrapping: true,\r\n                    lint: true,\r\n                    lineNumbers: true,\r\n                    theme: 'material'\r\n                }} \r\n            />\r\n        </div>\r\n    )\r\n}","export const toCML = (programData, loopData, isNyuryokuShingou, tkData) => {\r\n    let output = \"\"\r\n    let every_data_teigi = \"\"\r\n    let every_program_teigi = \"\"\r\n    for (let dousa_group of programData) {\r\n        let dousa_group_index = programData.indexOf(dousa_group) + 1\r\n        every_program_teigi += \"B\" + dousa_group_index.toString() + \".1\\n\"\r\n        let dousa_jikkou_of_group = \"\"\r\n        for (let dousa_row of dousa_group) {\r\n            let dousa_jikkou_row_arr = []\r\n            for (let dousa of dousa_row) {\r\n                if (dousa.length !== 0) {\r\n                    const dousa_jiku = dousa_row.indexOf(dousa) + 1\r\n                    let cml_numbers = dousa[1].toString() + \".\" + dousa_jiku.toString()\r\n                    const tanniValue = tkData[dousa_jiku-1].tanniValue\r\n                    switch (dousa[0]) {\r\n                        case \"位置決め\":\r\n                            every_data_teigi += \"S\"+cml_numbers+\"=\"+getPulseValue(dousa[2][0], tanniValue,100).toString()+\"\\nA\"+cml_numbers+\"=\"+getPulseValue(dousa[2][1], tanniValue,1000).toString()+\"\\nP\"+cml_numbers+\"=\"+getPulseValue(dousa[2][2], tanniValue).toString()+`\\n`\r\n                            dousa_jikkou_row_arr.push(`S${cml_numbers},A${cml_numbers},P${cml_numbers}`)\r\n                            break\r\n                        case \"位置決め+\":\r\n                            every_data_teigi += \"S\"+cml_numbers+\"=\"+getPulseValue(dousa[2][0], tanniValue,100).toString()+\"\\nA\"+cml_numbers+\"=\"+getPulseValue(dousa[2][1], tanniValue,1000).toString()+\"\\nP\"+cml_numbers+\"=\"+getPulseValue(dousa[2][2], tanniValue).toString()+`\\n`\r\n                            dousa_jikkou_row_arr.push(`S${cml_numbers},A${cml_numbers},P${cml_numbers}+`)\r\n                            break\r\n                        case \"押付け\":\r\n                            every_data_teigi += \"S\"+cml_numbers+\"=\"+getPulseValue(dousa[2][0], tanniValue,100).toString()+\"\\nA\"+cml_numbers+\"=\"+getPulseValue(dousa[2][1], tanniValue,1000).toString()+\"\\nP\"+cml_numbers+\"=\"+getPulseValue(dousa[2][2], tanniValue).toString()+\"\\n\"\r\n                            dousa_jikkou_row_arr.push(`S${cml_numbers},A${cml_numbers},Q${cml_numbers}`)\r\n                            break\r\n                        case \"押付け+\":\r\n                            every_data_teigi += \"S\"+cml_numbers+\"=\"+getPulseValue(dousa[2][0], tanniValue,100).toString()+\"\\nA\"+cml_numbers+\"=\"+getPulseValue(dousa[2][1], tanniValue,1000).toString()+\"\\nP\"+cml_numbers+\"=\"+getPulseValue(dousa[2][2], tanniValue).toString()+\"\\n\"\r\n                            dousa_jikkou_row_arr.push(`S${cml_numbers},A${cml_numbers},Q${cml_numbers}+`)\r\n                            break\r\n                        case \"タイマ\":\r\n                            every_data_teigi += \"T\"+cml_numbers+\"=\"+getPulseValue(dousa[2][0], tanniValue).toString()+\"\\n\"\r\n                            dousa_jikkou_row_arr.push(`T${cml_numbers}`)\r\n                            break\r\n                        case \"入力点からの実行\":\r\n                            isNyuryokuShingou = true\r\n                            break\r\n                        default:\r\n                            alert('ERROR-表を直してください')\r\n                            break\r\n                    }\r\n                }\r\n            }\r\n            let loop_start = \"\"\r\n            let loop_end = \"\"\r\n            for (let loop of loopData) {\r\n                if (loop[0][0] === programData.indexOf(dousa_group).toString() && loop[0][1] === dousa_group.indexOf(dousa_row).toString()) {\r\n                    loop_start = `X${loop[2]}.1\\n`\r\n                }\r\n                if (loop[1][0] === programData.indexOf(dousa_group).toString() && loop[1][1] === dousa_group.indexOf(dousa_row).toString()) {\r\n                    loop_end = `X.1-\\n`\r\n                }\r\n            }\r\n            if (dousa_jikkou_row_arr.length >= 1) {\r\n                dousa_jikkou_of_group += loop_start + dousa_jikkou_row_arr.join(\",\") + \"\\n\" + loop_end\r\n            } else {\r\n                dousa_jikkou_of_group += loop_start + loop_end\r\n            }\r\n        }\r\n        every_program_teigi += dousa_jikkou_of_group\r\n    }\r\n    \r\n    output += every_data_teigi\r\n    output += every_program_teigi\r\n    if (isNyuryokuShingou) {\r\n        let nyuryokuTxt = `\\nK81=1\\nK82=1\\nL1.1\\nI1.1,JL2.1,T0.1\\nI2.1,JL3.1,T0.1\\nI3.1,JL4.1,T0.1\\nI4.1,].1:].1,T0.1\\nL2.1\\n[1.1\\nI1.1,W0.1,JL1.1\\nL3.1\\n[2.1\\nI2.1,W0.1,JL1.1\\nL4.1\\n[3.1\\nI3.1,W0.1,JL1.1\\nEND`\r\n        return output + \"END\" + nyuryokuTxt\r\n    } else {\r\n        return output + \"END\"\r\n    }\r\n}\r\n\r\nconst getPulseValue = (valueArr, tanniValue, divideVar=1) => {\r\n    let value = parseFloat(valueArr[0])\r\n    const tanni = valueArr[1]\r\n    if (tanni.includes(\"pps\") || tanni.includes(\"%\") || tanni.includes('msec')) {\r\n        return Math.round(value)\r\n    } else {\r\n        return Math.round(value * tanniValue / divideVar)\r\n    }\r\n}","export default __webpack_public_path__ + \"static/media/決定、ボタン押下38.47b42841.mp3\";","export default __webpack_public_path__ + \"static/media/決定、ボタン押下44.6471b8fa.mp3\";","function str2ab(str) {\r\n    var buf = new ArrayBuffer(str.length * 2); // 2 bytes for each char\r\n    var bufView = new Uint16Array(buf);\r\n    for (var i = 0, strLen = str.length; i < strLen; i++) {\r\n        bufView[i] = str.charCodeAt(i);\r\n    }\r\n    return buf;\r\n}\r\n\r\nexport async function pressRun (cml) {\r\n    let cmlChunkList = cml.split('\\n')\r\n\r\n    const port = await navigator.serial.requestPort();\r\n    await port.open({ baudRate: 38400 });\r\n    const writer = port.writable.getWriter();\r\n    for (let cmlChunk of cmlChunkList) {\r\n        await writer.write(str2ab(cmlChunk + '\\r\\n'));\r\n    }\r\n    await writer.write(str2ab(\"[.1\" + '\\r\\n'));\r\n    writer.releaseLock();\r\n    await port.close();\r\n}\r\n\r\nexport async function stop() {\r\n    const port = await navigator.serial.requestPort();\r\n    await port.open({ baudRate: 38400 });\r\n    const writer = port.writable.getWriter();\r\n    await writer.write(str2ab('].1' + '\\r\\n'));\r\n    writer.releaseLock();\r\n    await port.close();\r\n}","import React, { useRef, useState } from 'react'\r\nimport { Button } from '@mui/material';\r\nimport { toCML } from './toCml';\r\nimport soundfile1 from './sounds/決定、ボタン押下38.mp3'\r\nimport soundfile2 from './sounds/決定、ボタン押下44.mp3'\r\nimport { pressRun, stop } from './serialPort';\r\n\r\nexport const ProgramBlock = (props) => {\r\n    const addRowRef = useRef()\r\n    const pgEmptyBox = useRef()\r\n\r\n    const [dousaNumArr, setDousaNumArr] = useState([1,0,0,0,0,0,0,0,0,0,0,0,0,0,0])\r\n\r\n    const trashInput = (e, programData, setProgramData) => {\r\n        const indexArr = e.target.parentNode.id.split('-')\r\n        indexArr.shift()\r\n        let tmp = [...programData]\r\n        tmp[parseFloat(indexArr[0])][parseFloat(indexArr[1])][parseFloat(indexArr[2])] = []\r\n        setProgramData(tmp) \r\n    }\r\n\r\n    const trashLoop = (e, loopData, setLoopData) => {\r\n        const indexArr = e.target.parentNode.id.split('-')\r\n        indexArr.shift()\r\n        let tmp = [...loopData]\r\n        let index = -1\r\n        tmp.forEach(loop => {\r\n            if (loop[0][0] === indexArr[0] && loop[0][1] === indexArr[1]) {\r\n                index = tmp.indexOf(loop)\r\n            }\r\n        })\r\n        if (index !== -1) {\r\n            tmp.splice(index, 1);\r\n        }\r\n        setLoopData(tmp) \r\n    }\r\n\r\n    const trashRow = (e, programData, setProgramData, loopData, setLoopData) => {\r\n        const indexArr = e.currentTarget.parentNode.id.split('-')\r\n        indexArr.shift()\r\n        let tmp = [...programData]\r\n        if (tmp[parseFloat(indexArr[0])].length > 1) {\r\n            tmp[parseFloat(indexArr[0])].splice(parseFloat(indexArr[1]), 1);        \r\n        } else {\r\n            let emptyRow = []\r\n            let i = 1\r\n            while (i <= props.jiku) {\r\n                emptyRow.push([])\r\n                i += 1\r\n            }\r\n            tmp[parseFloat(indexArr[0])] = [emptyRow]\r\n        }\r\n        // ------------------------------------\r\n        // --\r\n        let tmpLoop = [...loopData]\r\n        tmpLoop.forEach(loop => {\r\n            if (loop[0][0] === indexArr[0] && loop[0][1] === indexArr[1]) {\r\n                if (loop[1][1] === loop[0][1]) {\r\n                    tmpLoop.splice(tmpLoop.indexOf(loop), 1);\r\n                }\r\n            } else if (loop[1][0] === indexArr[0] && loop[1][1] === indexArr[1]) {\r\n                loop[1] = [indexArr[0], (parseFloat(indexArr[1])-1).toString()]\r\n            }\r\n        })\r\n\r\n        tmpLoop.forEach(loop => {\r\n            if ((programData[parseFloat(loop[0][0])].length - 1) < (loop[1][1] - parseFloat(loop[0][1]))) {\r\n                loop[1][1] = (parseFloat(loop[1][1])-1).toString()\r\n            }\r\n        })\r\n\r\n        setProgramData(tmp)\r\n        setLoopData(tmpLoop) \r\n    }\r\n\r\n    const trashGroup = (e, programData, setProgramData, loopData, setLoopData) => {\r\n        const indexArr = e.target.parentNode.id.split('-')\r\n        indexArr.shift()\r\n        let tmp = [...programData]\r\n        if (tmp.length > 1) {\r\n            tmp.splice(parseFloat(indexArr[0]), 1);\r\n        } else {\r\n            tmp = [[[]]]\r\n            let i = 1\r\n            while (i <= props.jiku) {\r\n                tmp[0][0].push([])\r\n                i += 1\r\n            }\r\n        }\r\n        // --\r\n        let tmpLoop = [...loopData]\r\n        tmpLoop.forEach(loop => {\r\n            if (loop[0][0] === indexArr[0]) {\r\n                indexArr.push(tmpLoop.indexOf(loop))\r\n            }\r\n        })\r\n        let i = tmpLoop.length\r\n        while (i--) {\r\n            if (tmpLoop[i][0][0] === indexArr[0]) {\r\n                tmpLoop.splice(i, 1)\r\n            }\r\n        }\r\n        setProgramData(tmp)\r\n        setLoopData(tmpLoop) \r\n    }\r\n\r\n    const trashJiku = (e) => {\r\n        const indexArr = e.currentTarget.parentNode.parentNode.id.split('-')\r\n        indexArr.shift()\r\n        const index = parseFloat(indexArr[0]) - 1\r\n        let tmp = [...props.programData]\r\n        if (props.jiku > 1) {\r\n            for (let dousa_group of tmp) {\r\n                for (let dousa_row of dousa_group) {\r\n                    dousa_row.splice(index, 1)\r\n                }\r\n            }\r\n            props.setJiku(props.jiku - 1)\r\n            let tkTmp = [...props.tkData]\r\n            if (index > -1) {\r\n                tkTmp.splice(index, 1)\r\n            }\r\n            props.setTkData(tkTmp)\r\n        } else {\r\n            tmp = [[[[]]]]\r\n            props.setLoopData([])\r\n        }\r\n        props.setProgramData(tmp)\r\n    }\r\n\r\n    const addRow = (e) => {\r\n        const indexArr = e.currentTarget.id.split('-')\r\n        indexArr.shift()\r\n        let emptyRow = []\r\n        let i = 0\r\n        while (i <= props.jiku-1) {\r\n            emptyRow.push([])\r\n            i += 1\r\n        }\r\n        let tmp = [...props.programData]\r\n        tmp[parseFloat(indexArr[0])].splice(parseFloat(indexArr[1]), 0, emptyRow)\r\n        props.setProgramData(tmp) \r\n    }\r\n\r\n    const addJiku = (e) => {\r\n        if (props.jiku <= 14) {\r\n            const indexArr = e.currentTarget.id.split('-')\r\n            indexArr.shift()\r\n            let tmp = [...props.programData]\r\n            for (let dousa_group of tmp) {\r\n                for (let dousa_row of dousa_group) {\r\n                    dousa_row.splice(parseFloat(indexArr[0])-1, 0, [])\r\n                }\r\n            }\r\n            props.setProgramData(tmp) \r\n            let tkTmp = [...props.tkData]\r\n            tkTmp.push({kikou: \"initial\", susumiryou: [1,1], gensoku: [1,1], bunkai: 300, tanniValue:1})\r\n            props.setTkData(tkTmp) \r\n            props.setJiku(props.jiku + 1)\r\n        } else {\r\n            alert(\"軸数は最大で15です。\")\r\n        }\r\n    }\r\n\r\n    const moveRow = (e, direction) => {\r\n        const indexArr = e.currentTarget.parentNode.parentNode.id.split('-')\r\n        indexArr.shift()\r\n        let tmp = [...props.programData]\r\n        const dousaGroup = tmp[parseFloat(indexArr[0])]\r\n        const rowIndex = parseFloat(indexArr[1])\r\n        switch (direction) {\r\n            case \"up\":\r\n                if (rowIndex >= 1) {\r\n                    [dousaGroup[rowIndex-1], dousaGroup[rowIndex]] = [dousaGroup[rowIndex], dousaGroup[rowIndex-1]]\r\n                }\r\n                break\r\n            case \"down\":\r\n                if (rowIndex < dousaGroup.length-1) {\r\n                    [dousaGroup[rowIndex+1], dousaGroup[rowIndex]] = [dousaGroup[rowIndex], dousaGroup[rowIndex+1]]\r\n                }\r\n                break\r\n            default:\r\n                break\r\n        }\r\n        props.setProgramData(tmp)\r\n    }\r\n\r\n    const moveJiku = (e, direction) => {\r\n        const indexArr = e.currentTarget.parentNode.id.split('-')\r\n        indexArr.shift()\r\n        let current_jiku = parseFloat(indexArr[0])\r\n        let tmp = [...props.programData]\r\n        let tkTmp = [...props.tkData]\r\n        switch (direction) {\r\n            case \"left\":\r\n                if (current_jiku !== 1) {\r\n                    for (let dousa_group of tmp) {\r\n                        for (let dousa_row of dousa_group) {\r\n                            let tmp_dousa = [...dousa_row[current_jiku-1]]\r\n                            dousa_row[current_jiku-1] = [...dousa_row[current_jiku-2]]\r\n                            dousa_row[current_jiku-2] = tmp_dousa\r\n                        }\r\n                    }\r\n                    let tmp_tk_item = tkTmp[current_jiku-1]\r\n                    tkTmp[current_jiku-1] = tkTmp[current_jiku-2]\r\n                    tkTmp[current_jiku-2] = tmp_tk_item\r\n                } \r\n                break\r\n            case \"right\":\r\n                if (current_jiku !== props.jiku) {\r\n                    for (let dousa_group of tmp) {\r\n                        for (let dousa_row of dousa_group) {\r\n                            let tmp_dousa = [...dousa_row[current_jiku-1]]\r\n                            dousa_row[current_jiku-1] = [...dousa_row[current_jiku]]\r\n                            dousa_row[current_jiku] = tmp_dousa\r\n                        }\r\n                    }\r\n                    let tmp_tk_item = tkTmp[current_jiku-1]\r\n                    tkTmp[current_jiku-1] = tkTmp[current_jiku]\r\n                    tkTmp[current_jiku] = tmp_tk_item\r\n                }\r\n                break\r\n            default:\r\n                break\r\n        }\r\n        props.setTkData(tkTmp) \r\n        props.setProgramData(tmp)\r\n    }\r\n\r\n    const showTypeData = (isLoop, parentId, jiku, dousaType, dousaNum) => {\r\n        if (!isLoop) {\r\n            const typeDataObj = [jiku, parentId, dousaType, dousaNum, false]\r\n            props.setTypeDataObj(typeDataObj)\r\n            props.setInputBoxType(\"typedata\")\r\n        } else {\r\n            props.setLoopInputObj([parentId, false])\r\n            props.setInputBoxType(\"loop\")\r\n        }\r\n    }\r\n\r\n    // Drag Functions\r\n    const emptyBoxDragStart = (e) => {\r\n        // e.currentTarget.className += \"dousa-box\"\r\n        // setTimeout(() => (e.currentTarget.className = 'dragged-box'), 0);\r\n        // e.currentTarget.style.cursor = \"grabbing\"\r\n    }\r\n    \r\n    const emptyBoxDragEnd = (e) => {\r\n        e.currentTarget.className = \"dousa-box\"\r\n        e.currentTarget.style.cursor = \"grab\"\r\n    }\r\n\r\n    function emptyBoxDragOver(e) {\r\n        if (props.currentDraggedCommand !== \"繰り返し\" && props.currentDraggedCommand !== \"動作グループを追加\" && props.currentDraggedCommand !== \"NOPE\") {\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    function emptyBoxDragEnter(e) {\r\n        if (props.currentDraggedCommand !== \"繰り返し\" && props.currentDraggedCommand !== \"動作グループを追加\" && props.currentDraggedCommand !== \"NOPE\") {\r\n            e.preventDefault();\r\n            e.target.className += ' pg-empty-hovered';\r\n        }\r\n    }\r\n\r\n    function emptyBoxDragLeave(e) {\r\n        e.target.className = 'pg-empty-box';\r\n    }\r\n\r\n    function emptyBoxDragDrop(e) {\r\n        const indexArr = e.target.id.split('-')\r\n        indexArr.shift()\r\n        let tmp = [...props.programData]\r\n        let audio = new Audio(soundfile2);\r\n        if (props.currentDraggedCommand !== \"繰り返し\" && props.currentDraggedCommand !== \"動作グループを追加\" && props.currentDraggedCommand !== \"NOPE\" && !props.currentDraggedCommand.includes(\"-\")) {\r\n            tmp[parseFloat(indexArr[0])][parseFloat(indexArr[1])][parseFloat(indexArr[2])] = [props.currentDraggedCommand, dousaNumArr[parseFloat(indexArr[2])]+1, [[\"数値を入力してください\", \"pps\"], [\"数値を入力してください\", \"pps\"], [\"数値を入力してください\", \"pps\"]]]\r\n            let tmpDousaNumArr = [...dousaNumArr]\r\n            tmpDousaNumArr[parseFloat(indexArr[2])] += 1\r\n            setDousaNumArr(tmpDousaNumArr)\r\n            props.setProgramData(tmp)\r\n            if (!props.isMute) {\r\n                audio.play();\r\n            }\r\n        } else if (props.currentDraggedCommand.includes(\"-\")) {\r\n            let draggedIndexArr = props.currentDraggedCommand.split(\"-\")\r\n            draggedIndexArr.shift()\r\n            tmp[parseFloat(indexArr[0])][parseFloat(indexArr[1])][parseFloat(indexArr[2])] = tmp[parseFloat(draggedIndexArr[0])][parseFloat(draggedIndexArr[1])][parseFloat(draggedIndexArr[2])]\r\n            tmp[parseFloat(draggedIndexArr[0])][parseFloat(draggedIndexArr[1])][parseFloat(draggedIndexArr[2])] = []\r\n            props.setProgramData(tmp)\r\n            if (!props.isMute) {\r\n                audio.play();\r\n            }\r\n        }\r\n    }\r\n    // -------\r\n    function emptyBoxLoopDragOver(e) {\r\n        if (props.currentDraggedCommand === \"繰り返し\") {\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    function emptyBoxLoopDragEnter(e) {\r\n        if (props.currentDraggedCommand === \"繰り返し\") {\r\n            e.preventDefault();\r\n            e.target.className += ' pg-l-empty-loop-hovered';\r\n        }\r\n    }\r\n\r\n    function emptyBoxLoopDragLeave(e) {\r\n        e.target.className = 'pg-l-empty-loop';\r\n    }\r\n\r\n    function emptyBoxLoopDragDrop(e) {\r\n        const indexArr = e.target.id.split('-')\r\n        indexArr.shift()\r\n        let tmp = [...props.loopData]\r\n        if (props.currentDraggedCommand === \"繰り返し\") {\r\n            tmp.push([[indexArr[0], indexArr[1]], [indexArr[0], indexArr[1]], 2])\r\n            props.setLoopData(tmp)\r\n            if (!props.isMute) {\r\n                let audio = new Audio(soundfile2);\r\n                audio.play();\r\n            }\r\n        } \r\n    }\r\n\r\n    const resizeLoop = (e, direction) => {\r\n        const indexArr = e.currentTarget.parentNode.parentNode.id.split('-')\r\n        indexArr.shift()\r\n        let tmp = [...props.loopData]\r\n        let mainItemIndex\r\n        tmp.forEach(loop => {\r\n            if (loop[0][0] === indexArr[0] && loop[0][1] === indexArr[1]) {\r\n                mainItemIndex = tmp.indexOf(loop)\r\n            }\r\n        })\r\n        let isDirectionAvailable = true\r\n        switch(direction) {\r\n            case \"top-up\":\r\n                tmp.forEach(loop => {\r\n                    if ((tmp.indexOf(loop) !== mainItemIndex) && (loop[1][0] === tmp[mainItemIndex][0][0] && loop[1][1] === tmp[mainItemIndex][0][1])) {\r\n                        isDirectionAvailable = false\r\n                    }\r\n                })\r\n                if (isDirectionAvailable && parseFloat(tmp[mainItemIndex][0][1]) >= 1) {\r\n                    tmp[mainItemIndex][0][1] = (parseFloat(tmp[mainItemIndex][0][1]) - 1).toString()\r\n                }\r\n                break\r\n            case \"top-down\":\r\n                if (tmp[mainItemIndex][0][1] !== tmp[mainItemIndex][1][1]) {\r\n                    tmp[mainItemIndex][0][1] = (parseFloat(tmp[mainItemIndex][0][1]) + 1).toString()\r\n                }\r\n                break\r\n            case \"bottom-up\":\r\n                if (tmp[mainItemIndex][0][1] !== tmp[mainItemIndex][1][1]) {\r\n                    tmp[mainItemIndex][1][1] = (parseFloat(tmp[mainItemIndex][1][1]) - 1).toString()\r\n                }\r\n                break\r\n            case \"bottom-down\":\r\n                for (let loop of tmp) {\r\n                    if ((tmp.indexOf(loop) !== mainItemIndex) && (loop[0][0] === tmp[mainItemIndex][1][0] && loop[0][1] === tmp[mainItemIndex][1][1])) {\r\n                        isDirectionAvailable = false\r\n                    }\r\n                }\r\n                let rowLength = props.programData[tmp[mainItemIndex][1][0]].length\r\n                if (isDirectionAvailable && parseFloat(tmp[mainItemIndex][1][1]) < (rowLength - 1)) {\r\n                    tmp[mainItemIndex][1][1] = (parseFloat(tmp[mainItemIndex][1][1]) + 1).toString()\r\n                }\r\n                break\r\n            default:\r\n                break \r\n        }\r\n        props.setLoopData(tmp)\r\n    }\r\n    // -------\r\n    function addGroupDragOver(e) {\r\n        if (props.currentDraggedCommand === \"動作グループを追加\") {\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    function addGroupDragEnter(e) {\r\n        e.currentTarget.style.height = \"30px\"\r\n        e.currentTarget.querySelector(\".add-row-plus-cont\").style.display = \"flex\"\r\n    }\r\n    \r\n    function addGroupDragLeave(e) {\r\n        e.currentTarget.style.height = \"0.2rem\"\r\n    }\r\n    \r\n    function addGroupDragDrop(e) {\r\n        let tmp = [...props.programData]\r\n        if (tmp.length <= 29) {\r\n\r\n            const indexArr = e.currentTarget.id.split('-')\r\n            indexArr.shift()\r\n            if (props.currentDraggedCommand === \"動作グループを追加\") {\r\n                let emptyGroup = [[]]\r\n                for (let z = 0; z < props.jiku; z++) emptyGroup[0].push([]);\r\n                tmp.splice((indexArr[0]+1), 0, emptyGroup); \r\n                props.setProgramData(tmp)\r\n            } \r\n            e.currentTarget.style.height = \"0.2rem\"\r\n        } else {\r\n            alert(\"動作グループ数は最大で30です。\")\r\n        }\r\n    }\r\n\r\n    const dousaBoxRef = useRef()\r\n\r\n    const dataToHTML = (programData) => {\r\n        let pg_l_arr = [<div className=\"pg-l-empty pglemp0\" key={\"first-pg-l-empty-box\"}></div>]\r\n        let main_grid = []\r\n        let jiku_i = 1\r\n        while (jiku_i <= props.jiku) {\r\n            const jiku_num = jiku_i\r\n            if (jiku_num === 1) {\r\n                main_grid.push(\r\n                <div className=\"jiku-number unselectable\" id={\"jiku-\"+jiku_num.toString()} key={\"jiku\"+jiku_num}>\r\n                    <div className=\"add-jiku-left\" id={\"addJiku-\"+jiku_num} onClick={(e) => addJiku(e)}>\r\n                        <div className=\"add-jiku-plus-cont\">\r\n                            <i className=\"fas fa-plus\"></i>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"add-jiku-right\" id={\"addJiku-\"+(jiku_num+1)} onClick={(e) => addJiku(e)}>\r\n                        <div className=\"add-jiku-plus-cont\">\r\n                            <i className=\"fas fa-plus\"></i>\r\n                        </div>\r\n                    </div>\r\n                    <i className=\"fas fa-arrow-alt-circle-left move-jiku\" onClick={(e) => moveJiku(e, \"left\")}></i>\r\n                    <p>\r\n                        {jiku_num}軸目<i className=\"fas fa-trash trash-jiku\" onClick={(e) => trashJiku(e)}></i>\r\n                    </p>\r\n                    <i className=\"fas fa-arrow-alt-circle-right move-jiku\" onClick={(e) => moveJiku(e, \"right\")}></i>\r\n                </div>)\r\n            } else if (jiku_num === 15) {\r\n                main_grid.push(<div className=\"jiku-number unselectable\" id={\"jiku-\"+jiku_num.toString()} key={\"jiku\"+jiku_num}><i className=\"fas fa-arrow-alt-circle-left move-jiku\" onClick={(e) => moveJiku(e, \"left\")}></i><p>{jiku_num}軸目<i className=\"fas fa-trash trash-jiku\" onClick={(e) => trashJiku(e)}></i></p><i className=\"fas fa-arrow-alt-circle-right move-jiku\" onClick={(e) => moveJiku(e, \"right\")}></i></div>)\r\n            } else {\r\n                main_grid.push(<div className=\"jiku-number unselectable\" id={\"jiku-\"+jiku_num.toString()} key={\"jiku\"+jiku_num}><div className=\"add-jiku-right\" id={\"addJiku-\"+(jiku_num+1)} onClick={(e) => addJiku(e)}><div className=\"add-jiku-plus-cont\"><i className=\"fas fa-plus\"></i></div></div><i className=\"fas fa-arrow-alt-circle-left move-jiku\" onClick={(e) => moveJiku(e, \"left\")}></i><p>{jiku_num}軸目<i className=\"fas fa-trash trash-jiku\" onClick={(e) => trashJiku(e)}></i></p><i className=\"fas fa-arrow-alt-circle-right move-jiku\" onClick={(e) => moveJiku(e, \"right\")}></i></div>)\r\n            }\r\n            jiku_i += 1\r\n        }\r\n        main_grid.push(<div className=\"empty-right-box\" key={\"empRbox-0firrrst\"}></div>)\r\n        main_grid.push(<div className=\"grid-line\" style={{gridColumn:\"1/\"+(props.jiku+1)}} key={\"first-grid-line-key\"}></div>)\r\n        main_grid.push(<div className=\"empty-right-box\" key={\"empRbox-ggggllllliiinnneeee\"}></div>)\r\n        let dousa_group_i = 0\r\n        for (let dousa_group of programData) {\r\n            pg_l_arr.push(<div className=\"pg-l-empty pglempgroup\" key={\"pglempty\"+dousa_group_i}></div>)\r\n            main_grid.push(<div className=\"dousa-group-kaishi unselectable\" style={{gridColumn:\"1/\"+(props.jiku+1)}} key={\"dousagroup-\"+dousa_group_i} id={\"dousaGroup-\"+dousa_group_i}><p>動作グループ{dousa_group_i+1}の開始</p><i className=\"fas fa-trash\" onClick={(e) => trashGroup(e, props.programData, props.setProgramData, props.loopData, props.setLoopData)}></i></div>)\r\n            main_grid.push(<div className=\"empty-right-box\" key={\"empRbox-\"+dousa_group_i}></div>)\r\n            let dontPutEmp = []\r\n            let dousa_row_i = 0\r\n            for (let dousa_row of dousa_group) {\r\n                let loopCount\r\n                props.loopData.forEach(loop => {\r\n                    if (loop[0][0] === dousa_group_i.toString() && loop[0][1] === dousa_row_i.toString()) {\r\n                        loopCount = loop[2]\r\n                        let loopHeight = loop[1][1] - loop[0][1] + 1\r\n                        let loopStyleHeight = loopHeight * 2.3 + ((loopHeight-1) * (0.2 + 0.4))\r\n                        for (let z = 0; z < loopHeight; z++) dontPutEmp.push(\"loop\");\r\n                        let dragArrows = [<div className=\"loop-drag-top\" key={\"loopdragtop\"}><div onClick={(e) => resizeLoop(e, \"top-up\")}><i className=\"fas fa-arrow-alt-circle-up\"></i></div><div onClick={(e) => resizeLoop(e, \"top-down\")}><i className=\"fas fa-arrow-alt-circle-down\"></i></div></div>,<div className=\"loop-drag-bottom\" key={\"loop-drag-bottom\"}><div onClick={(e) => resizeLoop(e, \"bottom-up\")}><i className=\"fas fa-arrow-alt-circle-up\"></i></div><div onClick={(e) => resizeLoop(e, \"bottom-down\")}><i className=\"fas fa-arrow-alt-circle-down\"></i></div></div>]\r\n                        if (loop[0][1] === loop[1][1]) {\r\n                            dragArrows = [<div className=\"loop-drag-top\" key={\"loopdragtop\"}><div onClick={(e) => resizeLoop(e, \"top-up\")}><i className=\"fas fa-arrow-alt-circle-up\"></i></div></div>,<div className=\"loop-drag-bottom\" key={\"loop-drag-bottom\"}><div onClick={(e) => resizeLoop(e, \"bottom-down\")}><i className=\"fas fa-arrow-alt-circle-down\"></i></div></div>]\r\n                        }\r\n                        const loopId = \"loop-\"+dousa_group_i+\"-\"+dousa_row_i\r\n                        pg_l_arr.push(\r\n                        <div className=\"pg-l-loop unselectable\" style={{height:loopStyleHeight+\"rem\"}} id={loopId} key={\"pglloop\"+dousa_row}>\r\n                            {dragArrows.map(dragArrow => {return dragArrow})}\r\n                            <p className=\"loop-title\" onClick={() => showTypeData(true, loopId)}>繰り返し{loopCount}回</p>\r\n                            <i className=\"fas fa-trash trash-block\" onClick={(e) => trashLoop(e, props.loopData, props.setLoopData)}></i>\r\n                        </div>)\r\n                    }\r\n                })\r\n                if (dontPutEmp.length === 0) {\r\n                    pg_l_arr.push(<div className=\"pg-l-empty-loop\" id={\"emptyloop-\"+dousa_group_i+\"-\"+dousa_row_i} onDragOver={(e) => emptyBoxLoopDragOver(e)} onDragEnter={(e) => emptyBoxLoopDragEnter(e)} onDragLeave={(e) => emptyBoxLoopDragLeave(e)} onDrop={(e) => emptyBoxLoopDragDrop(e)} key={\"pglemploop-\"+dousa_group_i+\"-\"+dousa_row_i}></div>)\r\n                } else {\r\n                    dontPutEmp.shift()\r\n                }\r\n                if (dousa_row_i === 0) {\r\n                    main_grid.push(<div ref={addRowRef} key={\"addrow0\"+dousa_group_i+\"-\"+dousa_row_i} id={\"addRow-\"+dousa_group_i+\"-0\"} onClick={(e) => addRow(e)} className=\"pg-add-row\" style={{gridColumn:\"1/\"+(props.jiku+1)}}><div className=\"add-row-plus-cont\"><i className=\"fas fa-plus\"></i></div></div>)\r\n                    main_grid.push(<div className=\"empty-right-box\" key={\"empRbox-\"+dousa_group_i+\"-\"+dousa_row_i}></div>)\r\n                }\r\n                let dousa_i = 0\r\n                for (let dousa of dousa_row) {\r\n                    if (dousa.length !== 0) {\r\n                        let noValueArr = []\r\n                        dousa[2].forEach(value => {if (value.includes(\"数値を入力してください\")) noValueArr.push(\"nope\")})\r\n                        const dousaId = \"dousa-\"+dousa_group_i+\"-\"+dousa_row_i+\"-\"+dousa_i\r\n                        const jikuOfDousa = dousa_i\r\n                        if (noValueArr.length > 0) {\r\n                            main_grid.push(<div ref={dousaBoxRef} className=\"dousa-box unselectable\" draggable=\"true\" onDragStart={(e) => emptyBoxDragStart(e)} onDragEnd={(e) => emptyBoxDragEnd(e)} onMouseEnter={(e) => props.setCurrentDraggedCommand(e.currentTarget.id)} key={dousa_group_i+\"dousabox\"+dousa_row_i+\"-\"+dousa_i} id={dousaId}><div className='no-value-circle'></div><p className='dousa-title' onClick={() => showTypeData(false, dousaId, jikuOfDousa, dousa[0], dousa[1])} >{dousa[0]}<span style={{marginRight:'0.2rem'}}></span>{dousa[1]}</p><i className=\"fas fa-trash\" onClick={(e) => trashInput(e, props.programData, props.setProgramData)}></i></div>)\r\n                        } else {\r\n                            main_grid.push(<div ref={dousaBoxRef} className=\"dousa-box unselectable\" draggable=\"true\" onDragStart={(e) => emptyBoxDragStart(e)} onDragEnd={(e) => emptyBoxDragEnd(e)} onMouseEnter={(e) => props.setCurrentDraggedCommand(e.currentTarget.id)} key={dousa_group_i+\"dousabox\"+dousa_row_i+\"-\"+dousa_i} id={dousaId}><p className='dousa-title' onClick={() => showTypeData(false, dousaId, jikuOfDousa, dousa[0], dousa[1])} >{dousa[0]}<span style={{marginRight:'0.2rem'}}></span>{dousa[1]}</p><i className=\"fas fa-trash\" onClick={(e) => trashInput(e, props.programData, props.setProgramData)}></i></div>)\r\n                        }\r\n                    } else {\r\n                        // main_grid.push(<div className=\"dousa-box\"></div>)\r\n                        main_grid.push(<div ref={pgEmptyBox} key={dousa_group_i+\"emptybox\"+dousa_row_i+\"-\"+dousa_i} onDragOver={(e) => emptyBoxDragOver(e)} onDragEnter={(e) => emptyBoxDragEnter(e)} onDragLeave={(e) => emptyBoxDragLeave(e)} onDrop={(e) => emptyBoxDragDrop(e)} className=\"pg-empty-box\" id={\"dousa-\"+dousa_group_i+\"-\"+dousa_row_i+\"-\"+dousa_i}></div>)\r\n                    } \r\n                    dousa_i += 1\r\n                }\r\n                main_grid.push(\r\n                    <div className=\"trash-row-right-box\" key={\"trashR-\"+dousa_group_i+\"-\"+dousa_row_i} id={\"trashRow-\"+dousa_group_i+\"-\"+(dousa_row_i)}>\r\n                        <i onClick={(e) => trashRow(e, props.programData, props.setProgramData, props.loopData, props.setLoopData)} className=\"fas fa-trash\"></i>\r\n                        <div className='move-row-cont'><i className='fas fa-arrow-alt-circle-up move-row-up' onClick={(e) => moveRow(e, \"up\")}></i><i className='fas fa-arrow-alt-circle-down move-row-down' onClick={(e) => moveRow(e, \"down\")}></i></div>\r\n                    </div>)\r\n                if (dousa_row_i !== (dousa_group.length-1)) {\r\n                    main_grid.push(<div ref={addRowRef} key={\"addrow\"+dousa_group_i+\"-\"+dousa_row_i} id={\"addRow-\"+dousa_group_i+\"-\"+(dousa_row_i+1)} onClick={(e) => addRow(e)} className=\"pg-add-row\" style={{gridColumn:\"1/\"+(props.jiku+1)}}><div className=\"add-row-plus-cont\"><i className=\"fas fa-plus\"></i></div></div>)\r\n                    main_grid.push(<div className=\"empty-right-box\" key={\"empRboxaddR-\"+dousa_group_i+\"-\"+dousa_row_i}></div>)\r\n                } else {\r\n                    main_grid.push(<div ref={addRowRef} key={\"addrow\"+dousa_group_i+\"-\"+dousa_row_i} id={\"addRow-\"+dousa_group_i+\"-\"+(dousa_row_i+1)} onClick={(e) => addRow(e)} onDragOver={(e) => addGroupDragOver(e)} onDragEnter={(e) => addGroupDragEnter(e)} onDragLeave={(e) => addGroupDragLeave(e)} onDrop={(e) => addGroupDragDrop(e)} className=\"pg-add-row\" style={{gridColumn:\"1/\"+(props.jiku+1),height:\"0.4rem\"}}><div className=\"add-row-plus-cont\"><i className=\"fas fa-plus\"></i></div></div>)\r\n                    main_grid.push(<div className=\"empty-right-box\" key={\"empRboxaddR-\"+dousa_group_i+\"-\"+dousa_row_i}></div>)\r\n                }\r\n                dousa_row_i += 1\r\n            }\r\n            dousa_group_i += 1\r\n        }\r\n\r\n        return (\r\n            <div className=\"program-grid\">\r\n                <div className=\"pg-left\">{pg_l_arr}</div>\r\n                <div className=\"program-main-grid\" style={{gridTemplateColumns:\"repeat(\"+props.jiku+\", 3fr) 1fr\"}}>{main_grid}</div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    // initially have 動作グループ1\r\n    return(\r\n        <div className=\"program-block\">\r\n            {dataToHTML(props.programData)}\r\n            <div className=\"enter-button\">\r\n                <Button variant=\"contained\" onClick={() => pressRun(toCML(props.programData, props.loopData, props.isNyuryokuShingou, props.tkData))}>実行</Button>\r\n                <div style={{height:10,width:30}}></div>\r\n                <Button variant=\"contained\" onClick={() => stop()}>停止</Button>\r\n                <div style={{height:10,width:30}}></div>\r\n                <Button variant=\"contained\" onClick={() => props.setCmlOutput(toCML(props.programData, props.loopData, props.isNyuryokuShingou, props.tkData))}>CMLへ変換</Button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport const TypeDataInDousa = (props) => {\r\n    // let dousaType = props.dousaType\r\n    // let dousaNum = props.dousaNum\r\n    // let parentId = props.parentId\r\n    const popupRef = useRef()\r\n    const tkData = props.tkData\r\n    // --\r\n    let indexArr = props.parentId.split('-')\r\n    indexArr.shift()\r\n    const jikuNum = parseFloat(indexArr[2])\r\n    // -\r\n    let tmp = [...props.programData]\r\n    // --\r\n    const closeTypeData = () => {\r\n        props.setInputBoxType(\"none\")\r\n    }\r\n\r\n    let subTanni = \"initial\"\r\n    if (tkData[jikuNum].kikou !== \"initial\") {\r\n        if (tkData[jikuNum].kikou === \"インデックステーブル\") {\r\n            subTanni = \"°\"\r\n        } else {\r\n            subTanni = \"mm\"\r\n        }\r\n    }\r\n\r\n    const ichigimeData = {\r\n        bangouRange: 250,\r\n        inputForm: subTanni===\"initial\" ? [\r\n            [\"速度データ\", [\"100pps\"], \"と\"],\r\n            [\"加速度データ\", [\"kpps\\u00b2\"], \"で\"],\r\n            [\"位置データ\", [\"Pulse\"], \"へ移動する\"],\r\n        ] : [\r\n            [\"速度データ\", [\"100pps\", subTanni+\"/s\"], \"と\"],\r\n            [\"加速度データ\", [\"kpps\\u00b2\", subTanni+\"/s\\u00b2\"], \"で\"],\r\n            [\"位置データ\", [\"Pulse\", subTanni], \"へ移動する\"],\r\n        ]\r\n    }\r\n    const incrementalIchigimeData = {\r\n        bangouRange: 250,\r\n        inputForm: subTanni===\"initial\" ? [\r\n            [\"速度データ\", [\"100pps\"], \"と\"],\r\n            [\"加速度データ\", [\"kpps\\u00b2\"], \"で\"],\r\n            [\"現在位置から\", [\"Pulse\"], \"移動する\"],\r\n        ] : [\r\n            [\"速度データ\", [\"100pps\", subTanni+\"/s\"], \"と\"],\r\n            [\"加速度データ\", [\"kpps\\u00b2\", subTanni+\"/s\\u00b2\"], \"で\"],\r\n            [\"現在位置から\", [\"Pulse\", subTanni], \"移動する\"],\r\n        ]\r\n    }\r\n    const oshitukeData = {\r\n        bangouRange: 250,\r\n        inputForm: subTanni===\"initial\" ? [\r\n            [\"速度データ\", [\"100pps\"], \"と\"],\r\n            [\"加速度データ\", [\"kpps\\u00b2\"], \"で\"],\r\n            [\"位置データ\", [\"Pulse\"], \"へ押付け動作する\"],\r\n        ] : [\r\n            [\"速度データ\", [\"100pps\", subTanni+\"/s\"], \"と\"],\r\n            [\"加速度データ\", [\"kpps\\u00b2\", subTanni+\"/s\\u00b2\"], \"で\"],\r\n            [\"位置データ\", [\"Pulse\", subTanni], \"へ押付け動作する\"],\r\n        ]\r\n    }\r\n    const incrementalOshitukeData = {\r\n        bangouRange: 250,\r\n        inputForm: subTanni===\"initial\" ? [\r\n            [\"速度データ\", [\"100pps\"], \"と\"],\r\n            [\"加速度データ\", [\"kpps\\u00b2\"], \"で\"],\r\n            [\"現在位置から\", [\"Pulse\"], \"押付け動作する\"],\r\n        ] : [\r\n            [\"速度データ\", [\"100pps\", subTanni+\"/s\"], \"と\"],\r\n            [\"加速度データ\", [\"kpps\\u00b2\", subTanni+\"/s\\u00b2\"], \"で\"],\r\n            [\"現在位置から\", [\"Pulse\", subTanni], \"押付け動作する\"],\r\n        ]\r\n    }\r\n    const timerData = {\r\n        bangouRange: 5,\r\n        inputForm: [\r\n            [\"タイマデータ\", [\"msec\"], \"に設定する\"],\r\n        ]\r\n    }\r\n\r\n    const nyuryokutenData = {\r\n        bangouRange: 4,\r\n    }\r\n\r\n    let dataFormat\r\n    switch(props.dousaType) {\r\n        case \"位置決め\":\r\n            dataFormat = ichigimeData\r\n            break\r\n        case \"押付け\":\r\n            dataFormat = oshitukeData\r\n            break\r\n        case \"タイマ\":\r\n            dataFormat = timerData\r\n            break\r\n        case \"位置決め+\":\r\n            dataFormat = incrementalIchigimeData\r\n            break\r\n        case \"押付け+\":\r\n            dataFormat = incrementalOshitukeData\r\n            break\r\n        case \"入力点からの実行\":\r\n            dataFormat = nyuryokutenData\r\n            break\r\n        default:\r\n            dataFormat = ichigimeData\r\n    }\r\n\r\n    const DousaInputBox = (props) => {\r\n        // props: dataFormat, numdropdown params\r\n        const dataFormat = props.dataFormat\r\n\r\n        const setTypeData = () => {\r\n            let isAllNumber = []\r\n            popupRef.current.querySelectorAll('.type-data-input').forEach(input => {\r\n                if (isNaN(parseFloat(input.value))) {\r\n                    isAllNumber.push(\"NAN\")\r\n                }\r\n            })\r\n            if (isAllNumber.length === 0) {\r\n                let tmp = [...props.programData]\r\n                let valueArr = []\r\n                let inputs = popupRef.current.querySelectorAll(\".type-data-input\")\r\n                let tanniSelectors = popupRef.current.querySelectorAll(\".select-tanni\")\r\n                let i = 0\r\n                while (i < inputs.length) {\r\n                    valueArr.push([inputs[i].value, tanniSelectors[i].value])\r\n                    i++\r\n                }\r\n                for (let dousa_group of tmp) {\r\n                    for (let dousa_row of dousa_group) {\r\n                        let dousa = dousa_row[props.jiku]\r\n                        if (dousa.length > 0) {\r\n                            // I don't get this code\r\n                            // if (props.dousaType !== (\"位置決め\"&&\"押付け\")) {\r\n                            // if (props.dousaType !== (\"位置決め\"||\"押付け\")) {\r\n                            //     if (dousa[1] === props.dousaNum && dousa[0] === props.dousaType) {\r\n                            //         dousa[2] = valueArr\r\n                            //     }\r\n                            // } else {\r\n                            //     if (dousa[1] === props.dousaNum) {\r\n                            //         dousa[2] = valueArr\r\n                            //     }\r\n                            // }\r\n                            if (dousa[1] === props.dousaNum && dousa[0] === props.dousaType) {\r\n                                dousa[2] = valueArr\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                tmp[parseFloat(indexArr[0])][parseFloat(indexArr[1])][parseFloat(indexArr[2])][2] = valueArr\r\n                props.setProgramData(tmp)\r\n                // --\r\n                closeTypeData()\r\n            } else {\r\n                isAllNumber = []\r\n                alert('数値を入力してください') \r\n            }\r\n        } \r\n    \r\n        return (\r\n            <div className=\"typeDataInDousa\" ref={popupRef}>\r\n                <div className=\"close-typedata\"><i onClick={() => closeTypeData()} className=\"fas fa-times-circle type-times-circle\"></i></div>\r\n                <div className='typedata-input-line' key={\"input-num-line\"}>\r\n                    <p className='typedata-var'>番号:</p>\r\n                    {\r\n                        props.dousaType === \"入力点からの実行\" ? \r\n                            <NumDropDown range={dataFormat.bangouRange} jiku={props.jiku} dousaType={props.dousaType} dousaNum={props.dousaNum} popupRef={props.popupRef} programData={props.programData} setProgramData={props.setProgramData} indexArr={props.indexArr}/>\r\n                            : <div className='current-num-container'><p className='current-num'>{ [...props.programData][parseFloat(indexArr[0])][parseFloat(indexArr[1])][parseFloat(indexArr[2])][1] }</p></div>\r\n                    }\r\n                </div>\r\n                {\r\n                    props.dousaType === \"入力点からの実行\" ? <></>\r\n                    : dataFormat.inputForm.map(inputLine => {\r\n                        return (\r\n                            <div className=\"typedata-input-line\" key={inputLine[0]}>\r\n                                <p className=\"typedata-var\">{inputLine[0]}</p>\r\n                                <DataInput index={dataFormat.inputForm.indexOf(inputLine)} tanniArr={inputLine[1]} />\r\n                                <p>{inputLine[2]}</p>\r\n                            </div>\r\n                        )\r\n                    }) \r\n                }\r\n                <Button className=\"type-data-button\" variant=\"contained\" onClick={() => setTypeData()}>OK</Button>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const DataInput = (props) => {\r\n        // const data = [100, \"pps\"]\r\n        const index = props.index\r\n        const tanniArr = props.tanniArr\r\n        const [value, setValue] = useState(tmp[parseFloat(indexArr[0])][parseFloat(indexArr[1])][parseFloat(indexArr[2])][2][index][0])\r\n        const [tanniState, setTanniState] = useState(tmp[parseFloat(indexArr[0])][parseFloat(indexArr[1])][parseFloat(indexArr[2])][2][index][1])\r\n        // ---\r\n\r\n        return (\r\n            <>\r\n                {value.toString().includes('数値を入力してください') ? \r\n                    <input className=\"type-data-input\" required placeholder={value} onChange={(e) => setValue(e.target.value)} />\r\n                    // : <input className=\"type-data-input\" required value={value} onChange={(e) => setValue(e.target.value)} />\r\n                    : <input className=\"type-data-input\" required defaultValue={value} onChange={(e) => setValue(e.target.value)} />\r\n                }\r\n                <div className=\"type-data-tanni\">\r\n                    <select className='select-tanni' value={tanniState} onChange={(e) => setTanniState(e.target.value)} >\r\n                        { tanniArr.map(tanni => {\r\n                            return <option key={tanni} value={tanni}>{tanni}</option>\r\n                        }) }\r\n                    </select>\r\n                </div>\r\n            </>\r\n        )\r\n    }\r\n\r\n    return (<DousaInputBox dataFormat={dataFormat} jiku={props.jiku} dousaType={props.dousaType} dousaNum={props.dousaNum} popupRef={popupRef} programData={props.programData} setProgramData={props.setProgramData} indexArr={indexArr}/>)\r\n}\r\n\r\nexport const LoopInputBox = (props) => {\r\n    // props: parentId, loopData, setLoopData\r\n    const popupRef = useRef()\r\n    let indexArr = props.parentId.split('-')\r\n    indexArr.shift()\r\n    // --\r\n    let tmp = [...props.loopData]\r\n    const [value, setValue] = useState(tmp[parseFloat(indexArr[0])][2])\r\n    // --\r\n    const closeTypeData = () => {\r\n        props.setInputBoxType(\"none\")\r\n    }\r\n\r\n    const setTypeData = () => {\r\n        let isAllNumber = []\r\n        if (isNaN(popupRef.current.querySelector('.type-data-input').value)) {\r\n                isAllNumber.push(\"NAN\")\r\n        }\r\n        if (isAllNumber.length === 0) {\r\n            let tmp = [...props.loopData]\r\n            let value = popupRef.current.querySelector(\".type-data-input\").value\r\n            tmp[parseFloat(indexArr[0])][2] = value\r\n            props.setLoopData(tmp)\r\n            // --\r\n            closeTypeData()\r\n        } else {\r\n            isAllNumber = []\r\n            alert('数値を入力してください') \r\n        }\r\n    } \r\n\r\n    return (\r\n        <div className=\"typeDataInDousa\" ref={popupRef}>\r\n            <div className=\"close-typedata\"><i onClick={() => closeTypeData()} className=\"fas fa-times-circle type-times-circle\"></i></div>\r\n            <div className=\"typedata-input-line\">\r\n                <input className=\"type-data-input\" required value={value} onChange={(e) => setValue(e.target.value)} />\r\n                <p>回繰り返す</p>\r\n            </div>\r\n            <Button className=\"type-data-button\" variant=\"contained\" onClick={() => setTypeData()}>OK</Button>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst NumDropDown = (props) => {\r\n    // props: programData, setProgramData, dataType, dataNum, popupRef, jiku, indexArr, range\r\n    const popupRef = props.popupRef\r\n    const indexArr = props.indexArr\r\n    let tmp = [...props.programData]\r\n    const [currentNum, setCurrentNum] = useState(tmp[parseFloat(indexArr[0])][parseFloat(indexArr[1])][parseFloat(indexArr[2])][1])\r\n    const numItemRef = useRef()\r\n    const currentNumRef = useRef()\r\n    \r\n    const selectItem = (e) => {\r\n        const value = parseFloat(e.currentTarget.id.split(\"-\")[2])\r\n        setCurrentNum(value)\r\n        numItemRef.current.style.display = \"none\"\r\n        let sameDataArr = []\r\n        for (let dousa_group of tmp) {\r\n            for (let dousa_row of dousa_group) {\r\n                let dousa = dousa_row[props.jiku]\r\n                if (dousa[1] === value && dousa[0] === props.dousaType) {\r\n                    sameDataArr.push(dousa[2])\r\n                }\r\n            }\r\n        }\r\n        if (sameDataArr.length > 0) {\r\n            tmp[parseFloat(indexArr[0])][parseFloat(indexArr[1])][parseFloat(indexArr[2])][2] = sameDataArr[0]\r\n            let inputs = popupRef.current.querySelectorAll(\".type-data-input\")\r\n            let tanniSelectors = popupRef.current.querySelectorAll(\".select-tanni\")\r\n            let i = 0\r\n            while (i < inputs.length) {\r\n                inputs[i].value = sameDataArr[0][i][0]\r\n                tanniSelectors[i].value = sameDataArr[0][i][1]\r\n                i++\r\n            }\r\n        }\r\n        tmp[parseFloat(indexArr[0])][parseFloat(indexArr[1])][parseFloat(indexArr[2])][1] = value\r\n        props.setProgramData(tmp)\r\n    }\r\n    const getNumItems = () => {\r\n        let res = []\r\n        let i = 1\r\n        while (i <= props.range) {\r\n            res.push(<div className='num-dropdown-item' key={i} id={\"num-dropdown-\"+i} onClick={(e) => selectItem(e)}><p>{i}</p></div>)\r\n            i += 1\r\n        }\r\n        return res\r\n    }\r\n    const showItems = () => {\r\n        let isItemsShown = numItemRef.current.style.display !== \"block\" ? false : true\r\n        if (!isItemsShown) {\r\n            numItemRef.current.style.display = \"block\"\r\n        } else {\r\n            numItemRef.current.style.display = \"none\"\r\n        }\r\n    }\r\n    return (\r\n        <div className='num-dropdown'>\r\n            <div className='currentNum-container' onClick={() => showItems()}><p ref={currentNumRef} className='currentNum'>{currentNum}</p><i className='fas fa-caret-down'></i></div>\r\n            <div ref={numItemRef} className='num-dropdown-item-container'>{getNumItems()}</div>\r\n        </div>\r\n    )\r\n}","import { useEffect, useState } from \"react\"\r\n\r\nconst PREFIX = 'CML-app-'\r\n\r\nexport default function useLocalStorage(key, initialValue) {\r\n    const prefixedKey = PREFIX + key\r\n\r\n    const [value, setValue] = useState(() => {\r\n        const jsonValue = localStorage.getItem(prefixedKey)\r\n        if (jsonValue != null) return JSON.parse(jsonValue)\r\n        \r\n        if (typeof initialValue === 'function') {\r\n            return initialValue()\r\n        } else {\r\n            return initialValue\r\n        }\r\n    })\r\n\r\n    useEffect(() => {\r\n        localStorage.setItem(prefixedKey, JSON.stringify(value))\r\n    }, [prefixedKey, value])\r\n\r\n    return [value, setValue] \r\n}","import { useRef } from \"react\"\r\n\r\nexport const SettingInfo = ({ text }) => {\r\n\r\n    const textBoxRef = useRef()\r\n\r\n    const display = () => {\r\n        textBoxRef.current.classList.add(\"shown\")\r\n        textBoxRef.current.classList.remove(\"hidden\")\r\n        setTimeout(() => {\r\n            if (!textBoxRef.current.classList.contains(\"hidden\")) {\r\n                textBoxRef.current.style.display = \"block\"\r\n            }\r\n        }, 300)\r\n    }\r\n\r\n    const hide = () => {\r\n        textBoxRef.current.classList.remove('shown')\r\n        textBoxRef.current.classList.add('hidden')\r\n        textBoxRef.current.style.display = \"none\"\r\n    }\r\n\r\n    return (\r\n        <div className=\"settings-panel-item-info-container\" onMouseEnter={() => display()} onMouseLeave={() => hide()}>\r\n            <i className=\"fa-solid fa-circle-question settings-panel-item-info\"></i>\r\n            <div ref={textBoxRef} className='settings-panel-item-info-box'>\r\n                <p>{ text }</p>\r\n            </div>\r\n        </div>\r\n    )\r\n}","import { Button } from '@mui/material'\r\nimport { useState } from 'react'\r\nimport { SettingInfo } from './settingInfo'\r\nimport './settingsPanel.css'\r\n\r\nexport const SettingsPanel = ({ closePanel }) => {\r\n\r\n    const [settings, setSettings] = useState({})\r\n\r\n    const settingsPanelData = {\r\n        \"kyoutuu\": [\r\n            {\"name\":\"inposition\", \"label\":\"インポジション幅\", \"inputType\":\"text\", \"infoText\":'インポジションと認識する幅を設定: 10.3 参照'},\r\n        ],\r\n        \"oshituke\": [\r\n            {\"name\":\"oshitukeDousaMode\", \"label\":\"押付け動作モード\", \"inputType\":\"text\", \"infoText\":'インポジションと認識する幅を設定: 10.3 参照'},\r\n            {\"name\":\"oshitukeDousaMode\", \"label\":\"押付け動作トルク\", \"inputType\":\"text\", \"infoText\":'インポジションと認識する幅を設定: 10.3 参照'},\r\n            {\"name\":\"oshitukeDousaMode\", \"label\":\"押付け動作保持時間\", \"inputType\":\"text\", \"infoText\":'インポジションと認識する幅を設定: 10.3 参照'},\r\n        ],\r\n        \"genten\": [\r\n            {\"name\":\"inposition\", \"label\":\"原点信号源\", \"inputType\":\"text\", \"infoText\":'インポジションと認識する幅を設定: 10.3 参照'},\r\n            {\"name\":\"inposition\", \"label\":\"原点検出速度\", \"inputType\":\"text\", \"infoText\":'インポジションと認識する幅を設定: 10.3 参照'},\r\n            {\"name\":\"inposition\", \"label\":\"原点検出加速度\", \"inputType\":\"text\", \"infoText\":'インポジションと認識する幅を設定: 10.3 参照'},\r\n            {\"name\":\"inposition\", \"label\":\"原点検出方向\", \"inputType\":\"text\", \"infoText\":'インポジションと認識する幅を設定: 10.3 参照'},\r\n            {\"name\":\"inposition\", \"label\":\"原点オフセット距離\", \"inputType\":\"text\", \"infoText\":'インポジションと認識する幅を設定: 10.3 参照'},\r\n            {\"name\":\"inposition\", \"label\":\"原点オフセット距離単位\", \"inputType\":\"text\", \"infoText\":'インポジションと認識する幅を設定: 10.3 参照'},\r\n            {\"name\":\"inposition\", \"label\":\"押当原点検出トルク\", \"inputType\":\"text\", \"infoText\":'インポジションと認識する幅を設定: 10.3 参照'},\r\n        ],\r\n    }\r\n\r\n    const SettingsPanelItem = ({ data }) => {\r\n        return (\r\n            <div className='settings-panel-item'>\r\n                <div className='settings-panel-item-label-container'>\r\n                    <p className='settings-panel-item-label'>{ data[\"label\"] }</p>\r\n                    <SettingInfo text={ data[\"infoText\"] } />\r\n                </div>\r\n                <input className='settings-panel-item-input'/>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const saveChanges = () => {\r\n        closePanel()\r\n    }\r\n\r\n    return (\r\n        <div id=\"settings-panel\">\r\n            <div id=\"close-settings-panel\" onClick={() => closePanel()}><i className=\"fas fa-times\"></i></div>\r\n            {/* content */}\r\n            <div className='settings-panel-block'>\r\n                <p className='settings-panel-block-label'>共通設定</p>\r\n                <div className='settings-panel-block-contents'>\r\n                    { settingsPanelData[\"kyoutuu\"].map((item, i) => <SettingsPanelItem data={item} key={i}/>) }\r\n                </div>\r\n            </div>\r\n            <div className='settings-panel-block'>\r\n                <p className='settings-panel-block-label'>押付け動作設定</p>\r\n                <div className='settings-panel-block-contents'>\r\n                    { settingsPanelData[\"oshituke\"].map((item, i) => <SettingsPanelItem data={item} key={i} />) }\r\n                </div>\r\n            </div>\r\n            <div className='settings-panel-block'>\r\n                <p className='settings-panel-block-label'>原点検出設定</p>\r\n                <div className='settings-panel-block-contents'>\r\n                    { settingsPanelData[\"genten\"].map((item, i) => <SettingsPanelItem data={item} key={i} />) }\r\n                </div>\r\n            </div>\r\n            <div id='save-changes-button'>\r\n                <Button variant=\"contained\" onClick={() => saveChanges()}>\r\n                    変更を保存\r\n                </Button>\r\n            </div>\r\n        </div>\r\n    )\r\n}","import { Button } from \"@mui/material\"\r\nimport { useEffect, useRef, useState } from \"react\"\r\n\r\n// ------------------------------------\r\nexport const WizardJiku = (props) => {\r\n\r\n    const params = props.params\r\n    const tkData = params.tannikannsannData\r\n    const [input, setInput] = useState(params.history.length >= 1 ? params.history[0][1] : [])\r\n    const checkBoxRef = useRef()\r\n\r\n    useEffect(() => {\r\n        input.forEach(num => {\r\n            checkBoxRef.current.querySelector('#jiku-'+num).checked = true\r\n        })\r\n    }, [input])\r\n\r\n    const jikuCheckBoxContainer = () => {\r\n        let res = []\r\n        let i = 1\r\n        while (i<=params.jiku) {\r\n            const num = i\r\n            res.push(\r\n                <div className=\"jiku-input-container\" key={num+\"jiku-input\"}>\r\n                    <input type=\"checkbox\" key={num+\"input\"} onChange={(e) => changeInput(e, num)} id={\"jiku-\"+num} name=\"jiku-sentaku\"/>\r\n                    <label htmlFor={\"jiku-\"+num} key={num+\"label\"}>{num}軸目</label>\r\n                </div>\r\n            )\r\n            i += 1\r\n        }\r\n        return res\r\n    }\r\n\r\n    const changeInput = (e, num) => {\r\n        const isChecked = e.currentTarget.checked\r\n        let tmp = [...input]\r\n        if (isChecked && !input.includes(num)) {\r\n            tmp.push(num)\r\n        } else {\r\n            const index = tmp.indexOf(num);\r\n            if (index > -1) {\r\n                tmp.splice(index, 1);\r\n            }\r\n        }\r\n        setInput(tmp)\r\n    }\r\n\r\n    const goNext = () => {\r\n        let isCheckedArr = []\r\n        checkBoxRef.current.querySelectorAll('input').forEach(checkBox => {\r\n            if (checkBox.checked === true) {\r\n                isCheckedArr.push(\"true\")\r\n            }\r\n        })\r\n        if (isCheckedArr.length >= 1) {\r\n            let tmp = [...params.history]\r\n            if (tmp.length >= 1) {\r\n                tmp[0][1] = input\r\n            } else {\r\n                tmp.push([\"jiku\", input])\r\n            }\r\n            params.setHistory(tmp)\r\n            params.setWizardInput([\"kikou\", input])\r\n        } else {\r\n            alert(\"軸を選択してください\")\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"tanni-wizard unselectable\">\r\n            <p className=\"tanni-wizard-title\">軸の選択</p>\r\n            <div ref={checkBoxRef} className=\"tanni-wizard-selector tanni-jiku\">\r\n                {jikuCheckBoxContainer()}\r\n            </div>\r\n            <div className=\"tanni-wizard-buttons\">\r\n                <Button className=\"tanni-next\" variant=\"contained\" onClick={() => goNext()}>NEXT</Button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n// ------------------------------------\r\n\r\nexport const WizardKikou = (props) => {\r\n    const params = props.params\r\n    const tkData = params.tannikannsannData\r\n    const jikuMainNum = params.history[0][1][0]-1\r\n    const [input, setInput] = useState(params.history.length >= 2 ? params.history[1][1] : (tkData[jikuMainNum].kikou !== \"initial\" ? tkData[jikuMainNum].kikou : \"ボールねじ\"))\r\n    const radioRef = useRef()\r\n\r\n    useEffect(() => {\r\n        let arr = [\"ボールねじ\", \"ベルト駆動\", \"ラックアンドピニオン\", \"インデックステーブル\"]\r\n        let i = arr.indexOf(input) + 1\r\n        radioRef.current.querySelector('#kikou-'+i).checked = true\r\n    }, [input])\r\n\r\n    const goBack = () => {\r\n        params.setWizardInput([\"jiku\", params.history[0][1]])\r\n    }\r\n\r\n    const goNext = () => {\r\n        let isCheckedArr = []\r\n        radioRef.current.querySelectorAll('input').forEach(input => {\r\n            if (input.checked === true) {\r\n                isCheckedArr.push(\"true\")\r\n            }\r\n        })\r\n        if (isCheckedArr.length !== 1) {\r\n            alert('機構を選択してください')\r\n        } else {\r\n            let tmp = [...params.history]\r\n            if (params.history.length === 1) {\r\n                tmp.push([\"kikou\", input])\r\n                if (input !== \"インデックステーブル\") {\r\n                    params.setWizardInput([\"susumiryou\", input])\r\n                } else {\r\n                    tmp.push([\"susumiryou\", 360, 360])\r\n                    params.setWizardInput([\"gensoku\", input])\r\n                }\r\n            } else {\r\n                tmp[1] = [\"kikou\", input]\r\n                if (input !== \"インデックステーブル\") {\r\n                    params.setWizardInput([\"susumiryou\", input])\r\n                } else {\r\n                    tmp[2] = [\"susumiryou\", 1]\r\n                    params.setWizardInput([\"gensoku\", input])\r\n                }\r\n            }\r\n            params.setHistory(tmp)\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"tanni-wizard unselectable\">\r\n            <p className=\"tanni-wizard-title\">機構の選択</p>\r\n            <div ref={radioRef} className=\"tanni-wizard-selector tanni-kikou\">\r\n                <div>\r\n                    <input type=\"radio\" onClick={(e) => setInput(e.currentTarget.value)} id=\"kikou-1\" name=\"kikou-sentaku\" value=\"ボールねじ\"/>\r\n                    <label htmlFor=\"kikou-1\">ボールねじ</label>\r\n                </div>\r\n                <div>\r\n                    <input type=\"radio\" onClick={(e) => setInput(e.currentTarget.value)} id=\"kikou-2\" name=\"kikou-sentaku\" value=\"ベルト駆動\" />\r\n                    <label htmlFor=\"kikou-2\">ベルト駆動</label>\r\n                </div>\r\n                <div>\r\n                    <input type=\"radio\" onClick={(e) => setInput(e.currentTarget.value)} id=\"kikou-3\" name=\"kikou-sentaku\" value=\"ラックアンドピニオン\" />\r\n                    <label htmlFor=\"kikou-3\">ラックアンドピニオン</label>\r\n                </div>\r\n                <div>\r\n                    <input type=\"radio\" onClick={(e) => setInput(e.currentTarget.value)} id=\"kikou-4\" name=\"kikou-sentaku\" value=\"インデックステーブル\" />\r\n                    <label htmlFor=\"kikou-4\">インデックステーブル</label>\r\n                </div>\r\n            </div>\r\n            <div className=\"tanni-wizard-buttons\">\r\n                <Button className=\"tanni-back\" variant=\"contained\" onClick={() => goBack()}>BACK</Button>\r\n                <Button className=\"tanni-next\" variant=\"contained\" onClick={() => goNext()}>NEXT</Button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport const WizardSusumiryou = (props) => {\r\n    const params = props.params\r\n    const tkData = params.tannikannsannData\r\n    const jikuMainNum = params.history[0][1][0]-1\r\n    const mode = params.history[1][1]\r\n    let susumiryouText = \"\"\r\n    let susumiryouVar = Math.PI\r\n    const [input, setInput] = useState((params.history.length >= 3) ? parseFloat(params.history[2][2]) : tkData[jikuMainNum].susumiryou[0])\r\n\r\n    switch (mode) {\r\n        case \"ボールねじ\":\r\n            susumiryouText = \"ボールねじリード\"\r\n            susumiryouVar = 1\r\n            break\r\n        case \"ベルト駆動\":\r\n            susumiryouText = \"プーリ直径\"\r\n            break\r\n        case \"ラックアンドピニオン\":\r\n            susumiryouText = \"ピニオン直径\"\r\n            break\r\n        default:\r\n            susumiryouText = \"ボールねじリード\"\r\n            break\r\n    }\r\n\r\n    const goNext = () => {\r\n        if (input !== \"\") {\r\n            let tmp = [...params.history]\r\n            if (params.history.length === 2) {\r\n                tmp.push([\"susumiryou\", Math.round((parseFloat(input)*susumiryouVar + Number.EPSILON) * 100) / 100, parseFloat(input)])\r\n            } else {\r\n                tmp[2] = [\"susumiryou\", Math.round((parseFloat(input)*susumiryouVar + Number.EPSILON) * 100) / 100, parseFloat(input)]\r\n            }\r\n            params.setHistory(tmp)\r\n            params.setWizardInput([\"gensoku\", input])\r\n        } else {\r\n            alert('数値を入力してください')\r\n        }\r\n    }\r\n\r\n    const goBack = () => {\r\n        let tmp = [...params.history]\r\n        let kikouValue = tmp[1][1]\r\n        params.setWizardInput([\"kikou\", kikouValue])\r\n    }\r\n\r\n    return (\r\n        <div className=\"tanni-wizard\">\r\n            <p className=\"tanni-wizard-title unselectable\">モータ1回転あたりの進み量</p>\r\n            <div className=\"tanni-wizard-selector tanni-susumi\">\r\n                <div className=\"susumi-1\">\r\n                    <p className='tanni-susumi-p'>{susumiryouText} : </p>\r\n                    {(params.history.length <= 2 && tkData[jikuMainNum].susumiryou[0]===0) ? \r\n                    <input type=\"text\" placeholder={0} onChange={(e) => setInput(e.currentTarget.value)}/>\r\n                    : <input type=\"text\" value={input} onChange={(e) => setInput(e.currentTarget.value)}/>\r\n                    }\r\n                    <p className='tanni-susumi-tanni'> mm</p>\r\n                </div>\r\n                <div className=\"susumi-2\">\r\n                    <p className='tanni-susumi-p'>進み量 : <span>{Math.round((parseFloat(input)*susumiryouVar + Number.EPSILON) * 100) / 100}</span> mm</p>\r\n                </div>\r\n            </div>\r\n            <div className=\"tanni-wizard-buttons unselectable\">\r\n                <Button className=\"tanni-back\" variant=\"contained\" onClick={() => goBack()}>BACK</Button>\r\n                <Button className=\"tanni-next\" variant=\"contained\" onClick={() => goNext()}>NEXT</Button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport const WizardGensoku = (props) => {\r\n    const params = props.params\r\n    const tkData = params.tannikannsannData\r\n    const jikuMainNum = params.history[0][1][0]-1\r\n    // const [input, setInput] = useState((params.history.length >= 4) ? params.history[3][1] : tkData[jikuMainNum].gensoku)\r\n    const [input1, setInput1] = useState((params.history.length >= 4) ? params.history[3][1][0] : tkData[jikuMainNum].gensoku[0])\r\n    const [input2, setInput2] = useState((params.history.length >= 4) ? params.history[3][1][1] : tkData[jikuMainNum].gensoku[1])\r\n    const checkBoxRef = useRef()\r\n    const selectorRef = useRef()\r\n\r\n    useEffect(() => {\r\n        if (((params.history.length > 3) && (params.history[3][1][0] !== (1||\"\") || params.history[3][1][1] !== (1||\"\"))) || (tkData[jikuMainNum].gensoku[0]!==(1||\"\") || tkData[jikuMainNum].gensoku[1]!==(1||\"\"))) {\r\n            selectorRef.current.style.opacity = \"1\"\r\n            checkBoxRef.current.checked = \"true\"\r\n            selectorRef.current.querySelectorAll(\"input\").forEach(input => {\r\n                input.readOnly = false\r\n            })\r\n        }\r\n    })\r\n\r\n    const goNext = () => {\r\n        if ((input1 && input2) !== \"\") {\r\n            let tmp = [...params.history]\r\n            if (params.history.length === 3) {\r\n                tmp.push([\"gensoku\", [input1, input2]])\r\n            } else {\r\n                tmp[3] = [\"gensoku\", [input1, input2]]\r\n            }\r\n            params.setHistory(tmp)\r\n            params.setWizardInput([\"bunkai\", [input1, input2]])\r\n        } else {\r\n            alert(\"数値を入力してください\")\r\n        }\r\n    }\r\n\r\n    const goBack = () => {\r\n        if (params.history[1][1] !== \"インデックステーブル\") {\r\n            params.setWizardInput([\"susumiryou\", 0])\r\n        } else {\r\n            params.setWizardInput([\"kikou\", 0])\r\n        }\r\n    }\r\n\r\n    const handleToggle = (e) => {\r\n        if (e.currentTarget.checked) {\r\n            selectorRef.current.style.opacity = \"1\"\r\n            selectorRef.current.querySelectorAll(\"input\").forEach(input => {\r\n                input.readOnly = false\r\n            })\r\n        } else {\r\n            setInput1(1)\r\n            setInput2(1)\r\n            selectorRef.current.style.opacity = \"0.4\"\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"tanni-wizard unselectable\">\r\n            <div className=\"tanni-wizard-title gensoku-title\"><input ref={checkBoxRef} type=\"checkbox\" onChange={(e) => handleToggle(e)} />減速比率</div>\r\n            <div ref={selectorRef} className=\"tanni-wizard-selector gensoku-selector\">\r\n                <table>\r\n                    <thead>\r\n                        <tr>\r\n                            <th>入力</th>\r\n                            <th></th>\r\n                            <th>出力</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        <tr>\r\n                            <td><input type=\"text\" readOnly value={input1} onChange={(e) => setInput1(e.currentTarget.value)}/></td>\r\n                            <td>  :  </td>\r\n                            <td><input type=\"text\" readOnly value={input2} onChange={(e) => setInput2(e.currentTarget.value)}/></td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n            <div className=\"tanni-wizard-buttons\">\r\n                <Button className=\"tanni-back\" variant=\"contained\" onClick={() => goBack()}>BACK</Button>\r\n                <Button className=\"tanni-next\" variant=\"contained\" onClick={() => goNext()}>NEXT</Button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport const WizardBunkai = (props) => {\r\n    const params = props.params\r\n    const tkData = params.tannikannsannData\r\n    const jikuMainNum = params.history[0][1][0]-1\r\n    const mode = params.history[1][1]\r\n    let bunkaiText = \"\"\r\n    let bunkaiVar = 1\r\n    const [input, setInput] = useState(params.history.length === 5 ? params.history[4][1] : tkData[jikuMainNum].bunkai)\r\n\r\n    switch (mode) {\r\n        case \"インデックステーブル\":\r\n            bunkaiText = \"°\"\r\n            bunkaiVar = 360 / (params.history[3][1][1]/params.history[3][1][0])\r\n            break\r\n        default:\r\n            bunkaiText = \"mm\"\r\n            bunkaiVar = params.history[2][1] / (params.history[3][1][1]/params.history[3][1][0])\r\n            break\r\n    }\r\n\r\n    const getTanniValue = () => {\r\n        return (1/parseFloat(params.history[2][1])) * parseFloat(input) * (parseFloat(params.history[3][1][1])/parseFloat(params.history[3][1][0]))\r\n    }\r\n\r\n    const goOK = () => {\r\n        let tkTmp = [...tkData]\r\n        params.history[0][1].forEach(jikuNum => {\r\n            tkTmp[jikuNum-1] = {kikou:params.history[1][1],susumiryou:[params.history[2][1],params.history[2][2]],gensoku:params.history[3][1],bunkai:input,tanniValue:getTanniValue()}\r\n        })\r\n        params.setTannikannsannData(tkTmp)\r\n        params.setHistory([])\r\n        props.close()\r\n    }\r\n\r\n    const goBack = () => {\r\n        params.setWizardInput([\"gensoku\", 0])\r\n    }\r\n\r\n    const changeInput = (item) => {\r\n        setInput(item)\r\n        let tmp = [...params.history]\r\n        if (tmp.length < 5) {\r\n            tmp.push([\"bunkai\", item])\r\n        } else {\r\n            tmp[4] = [\"bunkai\", item]\r\n        }\r\n        params.setHistory(tmp)\r\n    }\r\n\r\n    // decimal point function\r\n    function roundTo(n, digits) {\r\n        var negative = false;\r\n        if (digits === undefined) {\r\n            digits = 0;\r\n        }\r\n        if (n < 0) {\r\n            negative = true;\r\n            n = n * -1;\r\n        }\r\n        var multiplicator = Math.pow(10, digits);\r\n        n = parseFloat((n * multiplicator).toFixed(11));\r\n        n = (Math.round(n) / multiplicator).toFixed(digits);\r\n        if (negative) {\r\n            n = (n * -1).toFixed(digits);\r\n        }\r\n        return n;\r\n    }\r\n\r\n    return (\r\n        <div className=\"tanni-wizard unselectable\">\r\n            <p className=\"tanni-wizard-title\">最小位置決め単位</p>\r\n            <div className=\"tanni-wizard-selector tanni-bunkai\">\r\n                <div className=\"bunkai-1\">\r\n                    <p className=\"tanni-bunkai-text\">モータ分解能: </p>\r\n                    <Dropdown setItem={changeInput} defaultItem={input} itemArr={[300, 600, 1000, 1200, 2000, 3000, 5000, 6000, 10000, 12000]} />\r\n                    <p className=\"tanni-bunkai-text\">パルス/回転</p>\r\n                </div>\r\n                <div className=\"bunkai-2\">\r\n                    <p className=\"tanni-bunkai-text\">最小位置決め単位: <span>{roundTo(bunkaiVar/parseFloat(input) + Number.EPSILON, 5)}</span> {bunkaiText}</p>\r\n                </div>\r\n            </div>\r\n            <div className=\"tanni-wizard-buttons\">\r\n                <Button className=\"tanni-back\" variant=\"contained\" onClick={() => goBack()}>BACK</Button>\r\n                <Button className=\"tanni-ok\" variant=\"contained\" onClick={() => goOK()}>OK</Button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport const Dropdown = (props) => {\r\n    const itemArr = props.itemArr\r\n    const setItem = props.setItem\r\n\r\n    const [selectedItem, setSelectedItem] = useState(props.defaultItem !== undefined ? props.defaultItem : itemArr[0])\r\n    const dropdownItems = useRef()\r\n    const selectedItemRef = useRef()\r\n\r\n    const dropdowns = () => {\r\n        return itemArr.map(item => {\r\n            return (\r\n                <div className=\"dropdown-item unselectable\" onClick={(e) => clickItem(e)} key={item}>{item}</div>\r\n            )\r\n        })\r\n    }\r\n\r\n    const showItems = () => {\r\n        dropdownItems.current.style.display = \"block\"\r\n    }\r\n    \r\n    const clickItem = (e) => {\r\n        setSelectedItem(e.target.innerText)\r\n        setItem(e.target.innerText)\r\n        dropdownItems.current.style.display = \"none\"\r\n    }\r\n\r\n\r\n    return (\r\n        <div className=\"dropdown-selector\">\r\n            <div ref={selectedItemRef} className=\"selected-item unselectable\" onClick={() => showItems()}>{selectedItem}<i className=\"fas fa-angle-down\"></i></div>\r\n            <div ref={dropdownItems} className=\"dropdown-items unselectable\">\r\n                {dropdowns()}\r\n            </div>\r\n        </div>\r\n    )\r\n}","import React, { useRef, useState } from 'react';\r\nimport { SettingsPanel } from './settingsPanel/settingsPanel';\r\nimport { WizardGensoku, WizardKikou, WizardSusumiryou, WizardBunkai, WizardJiku } from './tanni-funcs';\r\nimport { toCML } from './toCml';\r\nimport { Link } from \"react-router-dom\";\r\n\r\n// Function to download data to a file\r\nexport const downloadFile = (data, filename, type) => {\r\n    var file = new Blob([data], {type: type});\r\n    if (window.navigator.msSaveOrOpenBlob) // IE10+\r\n        window.navigator.msSaveOrOpenBlob(file, filename);\r\n    else { // Others\r\n        let a = document.createElement(\"a\"),\r\n        url = URL.createObjectURL(file);\r\n        a.href = url;\r\n        a.download = filename;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        setTimeout(function() {\r\n            document.body.removeChild(a);\r\n            window.URL.revokeObjectURL(url);  \r\n        }, 0); \r\n    }\r\n}\r\n\r\nexport const TopMenu = (props) => {\r\n\r\n    const topMenuRef = useRef()\r\n    const muteIconRef = useRef()\r\n\r\n    const handleFileImport = (e) => {\r\n        const reader = new FileReader()\r\n        reader.onload = async (e) => { \r\n            // const obj = JSON.parse(e.target.result)\r\n            const obj = JSON.parse(reader.result)\r\n            // try {\r\n                props.setJiku(obj.data.jiku)\r\n                props.setTannikannsannData(obj.data.tannikannsannData)\r\n                props.setProgramData(obj.data.programData)\r\n                props.setLoopData(obj.data.loopData)\r\n                props.setCmlOutput(toCML(obj.data.programData, obj.data.loopData, obj.data.isNyuryokuShingou, obj.data.tannikannsannData))\r\n            // } catch (err) {\r\n            //     alert('ファイルが間違っています')\r\n            // }\r\n        };\r\n        reader.readAsText(e.target.files[0], \"utf-8\")\r\n    }\r\n\r\n    // Function to download data to a file\r\n    const downloadFile = (data, filename, type) => {\r\n        var file = new Blob([data], {type: type});\r\n        if (window.navigator.msSaveOrOpenBlob) // IE10+\r\n            window.navigator.msSaveOrOpenBlob(file, filename);\r\n        else { // Others\r\n            var a = document.createElement(\"a\"),\r\n            url = URL.createObjectURL(file);\r\n            a.href = url;\r\n            a.download = filename;\r\n            document.body.appendChild(a);\r\n            a.click();\r\n            setTimeout(function() {\r\n                document.body.removeChild(a);\r\n                window.URL.revokeObjectURL(url);  \r\n            }, 0); \r\n        }\r\n    }\r\n\r\n    const handleFileSave = () => {\r\n        let obj = {\"name\":\"cml-import\",\"data\":{\"jiku\":props.jiku,\"tannikannsannData\":props.tannikannsannData,\"programData\":props.programData,\"loopData\":props.loopData,\"isNyuryokuShingou\":props.isNyuryokuShingou}}\r\n        const data = JSON.stringify(obj)\r\n        const filename = \"CML-途中保存\"\r\n        const type = \".txt\"\r\n        downloadFile(data, filename, type)\r\n    }\r\n\r\n    const display = (ref) => {\r\n        ref.current.classList.add(\"shown\")\r\n        ref.current.classList.remove(\"hidden\")\r\n        setTimeout(() => {\r\n            if (!ref.current.classList.contains(\"hidden\")) {\r\n                ref.current.style.display = \"block\"\r\n            }\r\n        }, 500)\r\n    }\r\n\r\n    const hide = (ref) => {\r\n        ref.current.classList.remove('shown')\r\n        ref.current.classList.add('hidden')\r\n        ref.current.style.display = \"none\"\r\n    }\r\n\r\n    const openTanni = () => {\r\n        topMenuRef.current.querySelector('.tannikannsann-popup').style.display = \"flex\"\r\n        props.layerRef.current.style.display = \"block\"\r\n    }\r\n\r\n    const closeTanni = (topMenuRef, layerRef) => {\r\n        topMenuRef.current.querySelector('.tannikannsann-popup').style.display = \"none\"\r\n        layerRef.current.style.display = \"none\"\r\n    }\r\n\r\n    const openSettingsPanel = () => {\r\n        topMenuRef.current.querySelector('#settings-panel').style.display = \"flex\"\r\n        props.layerRef.current.style.display = \"block\"\r\n    }\r\n\r\n    const closeSettingsPanel = () => {\r\n        topMenuRef.current.querySelector('#settings-panel').style.display = \"none\"\r\n        props.layerRef.current.style.display = \"none\"\r\n    }\r\n\r\n    const toggleIsMute = (e) => {\r\n        let isPressed = muteIconRef.current.classList.contains(\"fa-volume-xmark\")\r\n        if (isPressed) {\r\n            muteIconRef.current.classList.remove(\"fa-volume-xmark\")\r\n            muteIconRef.current.classList.add(\"fa-volume-high\")\r\n            props.setIsMute(false)\r\n        } else {\r\n            muteIconRef.current.classList.remove(\"fa-volume-high\")\r\n            muteIconRef.current.classList.add(\"fa-volume-xmark\")\r\n            props.setIsMute(true)\r\n        }\r\n    }\r\n\r\n    const muteIcon = props.isMute ? \"volume-xmark\" : \"volume-high\"\r\n    // --\r\n    const expSave = useRef() \r\n    const expImp = useRef() \r\n    const expTanni = useRef() \r\n\r\n    return (\r\n        <div ref={topMenuRef} className=\"top-menu\">\r\n            <div className=\"top-menu-button save-file unselectable\" onMouseEnter={() => display(expSave)} onMouseLeave={() => hide(expSave)} onClick={() => handleFileSave()}>\r\n                <i className=\"fa-solid fa-floppy-disk\"></i>プロジェクトファイルを保存\r\n                <div ref={expSave} className=\"exp-box hidden\">作成途中のプロジェクトを保存します</div>\r\n            </div>\r\n            \r\n            <div className=\"top-menu-button import-file unselectable\" onMouseEnter={() => display(expImp)} onMouseLeave={() => hide(expImp)}>\r\n                <label htmlFor=\"top-menu-file-upload\">\r\n                    <i className=\"fa-solid fa-folder-open\"></i>プロジェクトファイルを開く\r\n                    <input id=\"top-menu-file-upload\" accept=\".txt\" type=\"file\" onChange={(e) => handleFileImport(e)}/>\r\n                </label>\r\n                <div ref={expImp} className=\"exp-box hidden\">保存したプロジェクトを開きます</div>\r\n            </div>\r\n            <div className=\"top-menu-button tannikannsann unselectable\" onMouseEnter={() => display(expTanni)} onMouseLeave={() => hide(expTanni)} onClick={() => openTanni()}>\r\n                <i className=\"fa-solid fa-gears\"></i>単位換算\r\n                <div ref={expTanni} className=\"exp-box hidden\">表示単位と分解能を設定します</div>\r\n            </div>\r\n            <Tannikannsann jiku={props.jiku} tannikannsannData={props.tannikannsannData} setTannikannsannData={props.setTannikannsannData} application={props.application} setApplication={props.setApplication} tanniValue={props.tanniValue} setTanniValue={props.setTanniValue} layerRef={props.layerRef} topMenuRef={topMenuRef} closeTanni={closeTanni}/>\r\n            <div className=\"top-menu-button settings unselectable\" onClick={() => openSettingsPanel()}>\r\n                <i className=\"fa-solid fa-gear\"></i>各種設定\r\n            </div>\r\n            <SettingsPanel closePanel={closeSettingsPanel} />\r\n            <div className='top-menu-button mute-button unselectable' onClick={(e) => toggleIsMute(e)}>\r\n                <i ref={muteIconRef} className={\"fa-solid fa-\"+muteIcon}></i>\r\n            </div>\r\n            <Link to=\"eng\">\r\n                <div className='top-menu-button language-button unselectable'>\r\n                    <i className={\"fa-solid fa-globe\"}></i>Eng\r\n                </div>\r\n            </Link>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst Tannikannsann = (props) => {\r\n    // props: tanniValue, setTanniValue, application, setApplication, tannikannsannData, setTannikannsannData\r\n    \r\n    const close = () => {\r\n        props.closeTanni(props.topMenuRef, props.layerRef)\r\n    }\r\n    \r\n    const WizardController = (props) => {\r\n        const [history, setHistory] = useState([])\r\n        const [wizardInput, setWizardInput] = useState([\"jiku\", []])\r\n\r\n        const inputForm = () => {\r\n            const params = {\r\n                wizardInput: wizardInput[1], \r\n                history, setHistory, setWizardInput,\r\n                tannikannsannData: props.tannikannsannData, setTannikannsannData: props.setTannikannsannData,\r\n                jiku: props.jiku\r\n            }\r\n        \r\n            switch (wizardInput[0]) {\r\n                case \"jiku\":\r\n                    return <WizardJiku params={params} />\r\n                case \"kikou\":\r\n                    return <WizardKikou params={params} />\r\n                case \"susumiryou\":\r\n                    return <WizardSusumiryou params={params} />\r\n                case \"gensoku\":\r\n                    return <WizardGensoku params={params} />\r\n                case \"bunkai\":\r\n                    return <WizardBunkai close={props.close} params={params} />\r\n                default:\r\n                    return <WizardKikou params={params}/>\r\n            }\r\n        }\r\n\r\n        return (\r\n            <div className='wizard-controller'>\r\n                    {inputForm()}\r\n            </div>\r\n        )\r\n    } \r\n\r\n    return (\r\n        <div className=\"tannikannsann-popup\">\r\n            <div className=\"close-popup close-tannikannsann\" onClick={() => close()}><i className=\"fas fa-times-circle\"></i></div>\r\n            <WizardController close={close} jiku={props.jiku} tannikannsannData={props.tannikannsannData} setTannikannsannData={props.setTannikannsannData} />\r\n        </div>\r\n    )\r\n}\r\n","export default __webpack_public_path__ + \"static/media/popup-instruction.495acebe.png\";","import { Button } from '@mui/material';\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport './App.css'\r\nimport './program-grid.css'\r\nimport { Editor } from './Editor';\r\nimport { ProgramBlock, TypeDataInDousa, LoopInputBox } from './programBlock';\r\nimport useLocalStorage from './useLocalStorage';\r\nimport { TopMenu, downloadFile } from './menu';\r\nimport soundfile1 from './sounds/決定、ボタン押下38.mp3'\r\nimport soundfile2 from './sounds/決定、ボタン押下44.mp3'\r\nimport instructionImg from './image/popup-instruction.png'\r\n\r\nexport const App = () => {\r\n\r\n    useEffect(() => {\r\n        document.title = 'CML自動生成ツール | MUSCLE CORPORATION';\r\n      }, []);\r\n\r\n    const [cmlOutput, setCmlOutput] = useLocalStorage('CML', '')\r\n    const [isNyuryokuShingou, setIsNyuryokuShingou] = useState(false)\r\n    // const [isNyuryokuShingou, setIsNyuryokuShingou] = useLocalStorage(\"nyuryokushingou\", false)\r\n    const [isMute, setIsMute] = useState(false)\r\n    const [jiku, setJiku] = useState(1)\r\n    let initialTannikannsannData = []\r\n    for (let i=0; i < jiku; i++) {\r\n        initialTannikannsannData.push({kikou: \"initial\", susumiryou: [1,1], gensoku: [1,1], bunkai: 300, tanniValue:1})\r\n    }\r\n    const [tannikannsannData, setTannikannsannData] = useState(initialTannikannsannData)\r\n    // const [programData, setProgramData] = useState([[[[\"位置決め\", 1, [[100, \"pps\"], [100, \"pps\"], [100, \"pps\"]]],[],[]],[[],[],[]],[[],[],[]]]])\r\n    const [programData, setProgramData] = useState([[[[\"位置決め\", 1, [[100, \"pps\"], [100, \"pps\"], [100, \"pps\"]]]],[[]],[[]]]])\r\n    const [loopData, setLoopData] = useState([])\r\n    const [currentDraggedCommand, setCurrentDraggedCommand] = useState(\"位置決め\")\r\n\r\n    // typeDataObj: [jiku, parentId, dousaType, dousaNum, isInitial]\r\n    // loopInputObj: [parentId, isInitial]\r\n    const [typeDataObj, setTypeDataObj] = useState(new Array(5))\r\n    const [loopInputObj, setLoopInputObj] = useState(new Array(2))\r\n    const [inputBoxType, setInputBoxType] = useState(\"none\")\r\n\r\n    const typeDataRef = useRef()\r\n    const loopInputRef = useRef()\r\n    const expCopy = useRef()\r\n    const expCopyDone = useRef()\r\n    const layerRef = useRef()\r\n    const commandSelectorRef = useRef()\r\n    const instructionPopupRef = useRef()\r\n\r\n    // const getIndex = (document) => {\r\n    //     let res = document.id.split('-')\r\n    //     res.shift()\r\n    //     return res\r\n    // }\r\n\r\n    const commandDragStart = (e) => {\r\n        if (!isMute) {\r\n            let audio = new Audio(soundfile1);\r\n            audio.play();\r\n        }\r\n    }\r\n\r\n    const commandHover = (e) => {\r\n        switch(e.target.id) {\r\n            case \"ichigime-selector\":\r\n                setCurrentDraggedCommand(\"位置決め\")\r\n                break\r\n            case \"oshituke-selector\":\r\n                setCurrentDraggedCommand(\"押付け\")\r\n                break\r\n            case \"taima-selector\":\r\n                setCurrentDraggedCommand(\"タイマ\")\r\n                break\r\n            case \"incremental-ichigime-selector\":\r\n                setCurrentDraggedCommand(\"位置決め+\")\r\n                break\r\n            case \"incremental-oshituke-selector\":\r\n                setCurrentDraggedCommand(\"押付け+\")\r\n                break\r\n            case \"nyuryokuten-selector\":\r\n                setCurrentDraggedCommand(\"入力点からの実行\")\r\n                break\r\n            case \"kurikaeshi-selector\":\r\n                setCurrentDraggedCommand(\"繰り返し\")\r\n                break\r\n            case \"dousaGroup-selector\":\r\n                setCurrentDraggedCommand(\"動作グループを追加\")\r\n                break\r\n            default:\r\n                setCurrentDraggedCommand(\"NOPE\")\r\n                break\r\n        }\r\n        // this.className += ' hold';\r\n        // setTimeout(() => (this.className = 'invisible'), 0);\r\n    }\r\n    // function dragEnd() {\r\n    //     this.className = 'fill';\r\n    // }\r\n\r\n    const copyCML = (cml) => {\r\n        navigator.clipboard.writeText(cml);\r\n        expCopy.current.style.display = \"none\"\r\n        expCopyDone.current.style.display = \"block\"\r\n        setTimeout(() => {\r\n            expCopyDone.current.style.display = \"none\"\r\n        }, 2000)\r\n    }\r\n\r\n    const display = (ref) => {\r\n        ref.current.classList.add(\"shown\")\r\n        ref.current.classList.remove(\"hidden\")\r\n        setTimeout(() => {\r\n            if (!ref.current.classList.contains(\"hidden\")) {\r\n                ref.current.style.display = \"block\"\r\n            }\r\n        }, 500)\r\n    }\r\n\r\n    const hide = (ref) => {\r\n        ref.current.classList.remove('shown')\r\n        ref.current.classList.add('hidden')\r\n        ref.current.style.display = \"none\"\r\n    }\r\n\r\n    const showPopUpOfInstruction = () => {\r\n        instructionPopupRef.current.style.display = \"flex\"\r\n        handleFileExport()\r\n    }\r\n\r\n    const handleFileExport = () => {\r\n        const data = cmlOutput\r\n        const filename = \"CML-保存\"\r\n        const type = \".txt\"\r\n        downloadFile(data, filename, type)\r\n    }\r\n\r\n    const DataInputBox = (props) => {\r\n        switch (props.inputBoxType) {\r\n            case \"typedata\":\r\n                return <TypeDataInDousa tkData={tannikannsannData} setInputBoxType={setInputBoxType} isInitial={typeDataObj[4]} jiku={typeDataObj[0]} parentId={typeDataObj[1]} dousaType={typeDataObj[2]} dousaNum={typeDataObj[3]} programData={programData} setProgramData={setProgramData}/>\r\n            case \"loop\":\r\n                return <LoopInputBox setInputBoxType={setInputBoxType} isInitial={loopInputObj[1]} parentId={loopInputObj[0]} loopData={loopData} setLoopData={setLoopData} />\r\n            default:\r\n                return <></>\r\n        }\r\n    }\r\n\r\n    const PopUpOfInstruction = () => {\r\n        const close = () => {\r\n            instructionPopupRef.current.style.display = \"none\"\r\n        }\r\n\r\n        return (\r\n            <div className='popup-instruction' ref={instructionPopupRef}>\r\n                <div className='popup-content'>\r\n                    <div id=\"close-instruction-popup\" onClick={() => close()}><i className=\"fas fa-times-circle\"></i></div>\r\n                    <img src={instructionImg} alt=\"instruction\" />\r\n                </div>\r\n                {/* <div className='popup-neveragain'>\r\n                    <p style={{marginRight:10}}>次回から表示しない</p>\r\n                    <input type={'checkbox'} />\r\n                </div> */}\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"main\">\r\n            <PopUpOfInstruction />\r\n            <DataInputBox inputBoxType={inputBoxType} />\r\n            <div ref={layerRef} className=\"layer\"></div>\r\n            <div className='top-menu-container'>\r\n                <TopMenu isMute={isMute} setIsMute={setIsMute} tannikannsannData={tannikannsannData} setTannikannsannData={setTannikannsannData} programData={programData} setProgramData={setProgramData} loopData={loopData} setLoopData={setLoopData} layerRef={layerRef} cmlOutput={cmlOutput} setCmlOutput={setCmlOutput} isNyuryokuShingou={isNyuryokuShingou} setIsNyuryokuShingou={setIsNyuryokuShingou} jiku={jiku} setJiku={setJiku}/>\r\n            </div>\r\n            <div className=\"center-section\">\r\n                <div className=\"command-list-width-box\"></div>\r\n                <div className='command-list-container'>\r\n                    <div className=\"command-list\">\r\n                        <div className='command-list-wrapper'>\r\n                            <div onMouseEnter={(e) => commandHover(e)} className=\"command-selector\" id=\"dousaGroup-selector\" draggable=\"true\"><i className=\"fas fa-grip-vertical\"></i>動作グループを追加</div>\r\n                            <div ref={commandSelectorRef} onDragStart={(e) => commandDragStart(e)} onMouseEnter={(e) => commandHover(e)} className=\"command-selector\" id=\"ichigime-selector\" draggable=\"true\"><i className=\"fas fa-grip-vertical\"></i>位置決め</div>\r\n                            <div ref={commandSelectorRef} onDragStart={(e) => commandDragStart(e)} onMouseEnter={(e) => commandHover(e)} className=\"command-selector\" id=\"oshituke-selector\" draggable=\"true\"><i className=\"fas fa-grip-vertical\"></i>押付け</div>\r\n                            <div ref={commandSelectorRef} onDragStart={(e) => commandDragStart(e)} onMouseEnter={(e) => commandHover(e)} className=\"command-selector\" id=\"taima-selector\" draggable=\"true\"><i className=\"fas fa-grip-vertical\"></i>タイマ</div>\r\n                            <div ref={commandSelectorRef} onDragStart={(e) => commandDragStart(e)} onMouseEnter={(e) => commandHover(e)} className=\"command-selector\" id=\"kurikaeshi-selector\" draggable=\"true\"><i className=\"fas fa-grip-vertical\"></i>繰り返し</div>\r\n                            <div ref={commandSelectorRef} onDragStart={(e) => commandDragStart(e)} onMouseEnter={(e) => commandHover(e)} className=\"command-selector\" id=\"incremental-ichigime-selector\" draggable=\"true\"><i className=\"fas fa-grip-vertical\"></i>位置決め+</div>\r\n                            <div ref={commandSelectorRef} onDragStart={(e) => commandDragStart(e)} onMouseEnter={(e) => commandHover(e)} className=\"command-selector\" id=\"incremental-oshituke-selector\" draggable=\"true\"><i className=\"fas fa-grip-vertical\"></i>押付け+</div>\r\n                            <div ref={commandSelectorRef} onDragStart={(e) => commandDragStart(e)} onMouseEnter={(e) => commandHover(e)} className=\"command-selector\" id=\"nyuryokuten-selector\" draggable=\"true\"><i className=\"fas fa-grip-vertical\"></i>入力点からの実行</div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div className='main-interface-section'>\r\n                    <div className='program-block-container'>\r\n                        <ProgramBlock isMute={isMute} tkData={tannikannsannData} setTkData={setTannikannsannData} setInputBoxType={setInputBoxType} inputBoxType={inputBoxType} loopInputObj={loopInputObj} setLoopInputObj={setLoopInputObj} typeDataObj={typeDataObj} setTypeDataObj={setTypeDataObj} typeDataRef={typeDataRef} loopInputRef={loopInputRef} isNyuryokuShingou={isNyuryokuShingou} setCmlOutput={setCmlOutput} loopData={loopData} setLoopData={setLoopData} programData={programData} setProgramData={setProgramData} jiku={jiku} setJiku={setJiku} currentDraggedCommand={currentDraggedCommand} setCurrentDraggedCommand={setCurrentDraggedCommand}/>\r\n                    </div>\r\n                    <div className='cml-output-container'>\r\n                        <div className=\"cml-output-section\">\r\n                            <h3 className='unselectable'>CML</h3>\r\n                            <Editor value={cmlOutput} onChange={setCmlOutput} />\r\n                            <div className=\"jikkou-button\">\r\n                                <Button variant=\"contained\" onClick={() => showPopUpOfInstruction()}>\r\n                                    テキストファイルに<br/>エクスポート\r\n                                </Button>\r\n                                <div className=\"copy-cml-container\">\r\n                                    <div className=\"copy-cml\" onMouseEnter={() => display(expCopy)} onMouseLeave={() => hide(expCopy)} onClick={() => copyCML(cmlOutput)}><i className=\"fas fa-copy\"></i></div>\r\n                                    <div ref={expCopy} className=\"exp-copy hidden\">コピー</div>\r\n                                    <div ref={expCopyDone} className=\"exp-copy-done hidden\">コピーされました</div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            {/* <div className=\"center-section\">\r\n                <TopMenu tannikannsannData={tannikannsannData} setTannikannsannData={setTannikannsannData} programData={programData} setProgramData={setProgramData} loopData={loopData} setLoopData={setLoopData} layerRef={layerRef} cmlOutput={cmlOutput} setCmlOutput={setCmlOutput} isNyuryokuShingou={isNyuryokuShingou} setIsNyuryokuShingou={setIsNyuryokuShingou} jiku={jiku} setJiku={setJiku}/>\r\n                <ProgramBlock tkData={tannikannsannData} setInputBoxType={setInputBoxType} inputBoxType={inputBoxType} loopInputObj={loopInputObj} setLoopInputObj={setLoopInputObj} typeDataObj={typeDataObj} setTypeDataObj={setTypeDataObj} typeDataRef={typeDataRef} loopInputRef={loopInputRef} isNyuryokuShingou={isNyuryokuShingou} setCmlOutput={setCmlOutput} loopData={loopData} setLoopData={setLoopData} programData={programData} setProgramData={setProgramData} jiku={jiku} setJiku={setJiku} currentDraggedCommand={currentDraggedCommand} setCurrentDraggedCommand={setCurrentDraggedCommand}/>\r\n            </div>\r\n            <div className=\"cml-output-section\">\r\n                <h3 className='unselectable'>CML</h3>\r\n                <Editor value={cmlOutput} onChange={setCmlOutput} />\r\n                <div className=\"jikkou-button\">\r\n                    <Button variant=\"contained\" onClick={() => handleFileExport()}>\r\n                        テキストファイルにエクスポート\r\n                    </Button>\r\n                    <div className=\"copy-cml-container\">\r\n                        <div className=\"copy-cml\" onMouseEnter={() => display(expCopy)} onMouseLeave={() => hide(expCopy)} onClick={() => copyCML(cmlOutput)}><i className=\"fas fa-copy\"></i></div>\r\n                        <div ref={expCopy} className=\"exp-copy hidden\">コピー</div>\r\n                        <div ref={expCopyDone} className=\"exp-copy-done hidden\">コピーされました</div>\r\n                    </div>\r\n                </div>\r\n            </div> */}\r\n        </div>\r\n    )\r\n}","import React, { useRef, useState } from 'react'\r\nimport { Button } from '@mui/material';\r\nimport { toCML } from '../toCml';\r\nimport soundfile1 from '../sounds/決定、ボタン押下38.mp3'\r\nimport soundfile2 from '../sounds/決定、ボタン押下44.mp3'\r\nimport { pressRun, stop } from '../serialPort';\r\n\r\nexport const ProgramBlockEng = (props) => {\r\n    const addRowRef = useRef()\r\n    const pgEmptyBox = useRef()\r\n\r\n    const [dousaNumArr, setDousaNumArr] = useState([1,0,0,0,0,0,0,0,0,0,0,0,0,0,0])\r\n\r\n    const trashInput = (e, programData, setProgramData) => {\r\n        const indexArr = e.target.parentNode.id.split('-')\r\n        indexArr.shift()\r\n        let tmp = [...programData]\r\n        tmp[parseFloat(indexArr[0])][parseFloat(indexArr[1])][parseFloat(indexArr[2])] = []\r\n        setProgramData(tmp) \r\n    }\r\n\r\n    const trashLoop = (e, loopData, setLoopData) => {\r\n        const indexArr = e.target.parentNode.id.split('-')\r\n        indexArr.shift()\r\n        let tmp = [...loopData]\r\n        let index = -1\r\n        tmp.forEach(loop => {\r\n            if (loop[0][0] === indexArr[0] && loop[0][1] === indexArr[1]) {\r\n                index = tmp.indexOf(loop)\r\n            }\r\n        })\r\n        if (index !== -1) {\r\n            tmp.splice(index, 1);\r\n        }\r\n        setLoopData(tmp) \r\n    }\r\n\r\n    const trashRow = (e, programData, setProgramData, loopData, setLoopData) => {\r\n        const indexArr = e.currentTarget.parentNode.id.split('-')\r\n        indexArr.shift()\r\n        let tmp = [...programData]\r\n        if (tmp[parseFloat(indexArr[0])].length > 1) {\r\n            tmp[parseFloat(indexArr[0])].splice(parseFloat(indexArr[1]), 1);        \r\n        } else {\r\n            let emptyRow = []\r\n            let i = 1\r\n            while (i <= props.jiku) {\r\n                emptyRow.push([])\r\n                i += 1\r\n            }\r\n            tmp[parseFloat(indexArr[0])] = [emptyRow]\r\n        }\r\n        // ------------------------------------\r\n        // --\r\n        let tmpLoop = [...loopData]\r\n        tmpLoop.forEach(loop => {\r\n            if (loop[0][0] === indexArr[0] && loop[0][1] === indexArr[1]) {\r\n                if (loop[1][1] === loop[0][1]) {\r\n                    tmpLoop.splice(tmpLoop.indexOf(loop), 1);\r\n                }\r\n            } else if (loop[1][0] === indexArr[0] && loop[1][1] === indexArr[1]) {\r\n                loop[1] = [indexArr[0], (parseFloat(indexArr[1])-1).toString()]\r\n            }\r\n        })\r\n\r\n        tmpLoop.forEach(loop => {\r\n            if ((programData[parseFloat(loop[0][0])].length - 1) < (loop[1][1] - parseFloat(loop[0][1]))) {\r\n                loop[1][1] = (parseFloat(loop[1][1])-1).toString()\r\n            }\r\n        })\r\n\r\n        setProgramData(tmp)\r\n        setLoopData(tmpLoop) \r\n    }\r\n\r\n    const trashGroup = (e, programData, setProgramData, loopData, setLoopData) => {\r\n        const indexArr = e.target.parentNode.id.split('-')\r\n        indexArr.shift()\r\n        let tmp = [...programData]\r\n        if (tmp.length > 1) {\r\n            tmp.splice(parseFloat(indexArr[0]), 1);\r\n        } else {\r\n            tmp = [[[]]]\r\n            let i = 1\r\n            while (i <= props.jiku) {\r\n                tmp[0][0].push([])\r\n                i += 1\r\n            }\r\n        }\r\n        // --\r\n        let tmpLoop = [...loopData]\r\n        tmpLoop.forEach(loop => {\r\n            if (loop[0][0] === indexArr[0]) {\r\n                indexArr.push(tmpLoop.indexOf(loop))\r\n            }\r\n        })\r\n        let i = tmpLoop.length\r\n        while (i--) {\r\n            if (tmpLoop[i][0][0] === indexArr[0]) {\r\n                tmpLoop.splice(i, 1)\r\n            }\r\n        }\r\n        setProgramData(tmp)\r\n        setLoopData(tmpLoop) \r\n    }\r\n\r\n    const trashJiku = (e) => {\r\n        const indexArr = e.currentTarget.parentNode.parentNode.id.split('-')\r\n        indexArr.shift()\r\n        const index = parseFloat(indexArr[0]) - 1\r\n        let tmp = [...props.programData]\r\n        if (props.jiku > 1) {\r\n            for (let dousa_group of tmp) {\r\n                for (let dousa_row of dousa_group) {\r\n                    dousa_row.splice(index, 1)\r\n                }\r\n            }\r\n            props.setJiku(props.jiku - 1)\r\n            let tkTmp = [...props.tkData]\r\n            if (index > -1) {\r\n                tkTmp.splice(index, 1)\r\n            }\r\n            props.setTkData(tkTmp)\r\n        } else {\r\n            tmp = [[[[]]]]\r\n            props.setLoopData([])\r\n        }\r\n        props.setProgramData(tmp)\r\n    }\r\n\r\n    const addRow = (e) => {\r\n        const indexArr = e.currentTarget.id.split('-')\r\n        indexArr.shift()\r\n        let emptyRow = []\r\n        let i = 0\r\n        while (i <= props.jiku-1) {\r\n            emptyRow.push([])\r\n            i += 1\r\n        }\r\n        let tmp = [...props.programData]\r\n        tmp[parseFloat(indexArr[0])].splice(parseFloat(indexArr[1]), 0, emptyRow)\r\n        props.setProgramData(tmp) \r\n    }\r\n\r\n    const addJiku = (e) => {\r\n        if (props.jiku <= 14) {\r\n            const indexArr = e.currentTarget.id.split('-')\r\n            indexArr.shift()\r\n            let tmp = [...props.programData]\r\n            for (let dousa_group of tmp) {\r\n                for (let dousa_row of dousa_group) {\r\n                    dousa_row.splice(parseFloat(indexArr[0])-1, 0, [])\r\n                }\r\n            }\r\n            props.setProgramData(tmp) \r\n            let tkTmp = [...props.tkData]\r\n            tkTmp.push({kikou: \"initial\", susumiryou: [1,1], gensoku: [1,1], bunkai: 300, tanniValue:1})\r\n            props.setTkData(tkTmp) \r\n            props.setJiku(props.jiku + 1)\r\n        } else {\r\n            alert(\"Maximum axis number is 15\")\r\n        }\r\n    }\r\n\r\n    const moveRow = (e, direction) => {\r\n        const indexArr = e.currentTarget.parentNode.parentNode.id.split('-')\r\n        indexArr.shift()\r\n        let tmp = [...props.programData]\r\n        const dousaGroup = tmp[parseFloat(indexArr[0])]\r\n        const rowIndex = parseFloat(indexArr[1])\r\n        switch (direction) {\r\n            case \"up\":\r\n                if (rowIndex >= 1) {\r\n                    [dousaGroup[rowIndex-1], dousaGroup[rowIndex]] = [dousaGroup[rowIndex], dousaGroup[rowIndex-1]]\r\n                }\r\n                break\r\n            case \"down\":\r\n                if (rowIndex < dousaGroup.length-1) {\r\n                    [dousaGroup[rowIndex+1], dousaGroup[rowIndex]] = [dousaGroup[rowIndex], dousaGroup[rowIndex+1]]\r\n                }\r\n                break\r\n            default:\r\n                break\r\n        }\r\n        props.setProgramData(tmp)\r\n    }\r\n\r\n    const moveJiku = (e, direction) => {\r\n        const indexArr = e.currentTarget.parentNode.id.split('-')\r\n        indexArr.shift()\r\n        let current_jiku = parseFloat(indexArr[0])\r\n        let tmp = [...props.programData]\r\n        let tkTmp = [...props.tkData]\r\n        switch (direction) {\r\n            case \"left\":\r\n                if (current_jiku !== 1) {\r\n                    for (let dousa_group of tmp) {\r\n                        for (let dousa_row of dousa_group) {\r\n                            let tmp_dousa = [...dousa_row[current_jiku-1]]\r\n                            dousa_row[current_jiku-1] = [...dousa_row[current_jiku-2]]\r\n                            dousa_row[current_jiku-2] = tmp_dousa\r\n                        }\r\n                    }\r\n                    let tmp_tk_item = tkTmp[current_jiku-1]\r\n                    tkTmp[current_jiku-1] = tkTmp[current_jiku-2]\r\n                    tkTmp[current_jiku-2] = tmp_tk_item\r\n                } \r\n                break\r\n            case \"right\":\r\n                if (current_jiku !== props.jiku) {\r\n                    for (let dousa_group of tmp) {\r\n                        for (let dousa_row of dousa_group) {\r\n                            let tmp_dousa = [...dousa_row[current_jiku-1]]\r\n                            dousa_row[current_jiku-1] = [...dousa_row[current_jiku]]\r\n                            dousa_row[current_jiku] = tmp_dousa\r\n                        }\r\n                    }\r\n                    let tmp_tk_item = tkTmp[current_jiku-1]\r\n                    tkTmp[current_jiku-1] = tkTmp[current_jiku]\r\n                    tkTmp[current_jiku] = tmp_tk_item\r\n                }\r\n                break\r\n            default:\r\n                break\r\n        }\r\n        props.setTkData(tkTmp) \r\n        props.setProgramData(tmp)\r\n    }\r\n\r\n    const showTypeData = (isLoop, parentId, jiku, dousaType, dousaNum) => {\r\n        if (!isLoop) {\r\n            const typeDataObj = [jiku, parentId, dousaType, dousaNum, false]\r\n            props.setTypeDataObj(typeDataObj)\r\n            props.setInputBoxType(\"typedata\")\r\n        } else {\r\n            props.setLoopInputObj([parentId, false])\r\n            props.setInputBoxType(\"loop\")\r\n        }\r\n    }\r\n\r\n    // Drag Functions\r\n    const emptyBoxDragStart = (e) => {\r\n        // e.currentTarget.className += \"dousa-box\"\r\n        // setTimeout(() => (e.currentTarget.className = 'dragged-box'), 0);\r\n        // e.currentTarget.style.cursor = \"grabbing\"\r\n    }\r\n    \r\n    const emptyBoxDragEnd = (e) => {\r\n        e.currentTarget.className = \"dousa-box\"\r\n        e.currentTarget.style.cursor = \"grab\"\r\n    }\r\n\r\n    function emptyBoxDragOver(e) {\r\n        if (props.currentDraggedCommand !== \"繰り返し\" && props.currentDraggedCommand !== \"動作グループを追加\" && props.currentDraggedCommand !== \"NOPE\") {\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    function emptyBoxDragEnter(e) {\r\n        if (props.currentDraggedCommand !== \"繰り返し\" && props.currentDraggedCommand !== \"動作グループを追加\" && props.currentDraggedCommand !== \"NOPE\") {\r\n            e.preventDefault();\r\n            e.target.className += ' pg-empty-hovered';\r\n        }\r\n    }\r\n\r\n    function emptyBoxDragLeave(e) {\r\n        e.target.className = 'pg-empty-box';\r\n    }\r\n\r\n    function emptyBoxDragDrop(e) {\r\n        const indexArr = e.target.id.split('-')\r\n        indexArr.shift()\r\n        let tmp = [...props.programData]\r\n        let audio = new Audio(soundfile2);\r\n        if (props.currentDraggedCommand !== \"繰り返し\" && props.currentDraggedCommand !== \"動作グループを追加\" && props.currentDraggedCommand !== \"NOPE\" && !props.currentDraggedCommand.includes(\"-\")) {\r\n            tmp[parseFloat(indexArr[0])][parseFloat(indexArr[1])][parseFloat(indexArr[2])] = [props.currentDraggedCommand, dousaNumArr[parseFloat(indexArr[2])]+1, [[\"Enter value here\", \"pps\"], [\"Enter value here\", \"pps\"], [\"Enter value here\", \"pps\"]]]\r\n            let tmpDousaNumArr = [...dousaNumArr]\r\n            tmpDousaNumArr[parseFloat(indexArr[2])] += 1\r\n            setDousaNumArr(tmpDousaNumArr)\r\n            props.setProgramData(tmp)\r\n            if (!props.isMute) {\r\n                audio.play();\r\n            }\r\n        } else if (props.currentDraggedCommand.includes(\"-\")) {\r\n            let draggedIndexArr = props.currentDraggedCommand.split(\"-\")\r\n            draggedIndexArr.shift()\r\n            tmp[parseFloat(indexArr[0])][parseFloat(indexArr[1])][parseFloat(indexArr[2])] = tmp[parseFloat(draggedIndexArr[0])][parseFloat(draggedIndexArr[1])][parseFloat(draggedIndexArr[2])]\r\n            tmp[parseFloat(draggedIndexArr[0])][parseFloat(draggedIndexArr[1])][parseFloat(draggedIndexArr[2])] = []\r\n            props.setProgramData(tmp)\r\n            if (!props.isMute) {\r\n                audio.play();\r\n            }\r\n        }\r\n    }\r\n    // -------\r\n    function emptyBoxLoopDragOver(e) {\r\n        if (props.currentDraggedCommand === \"繰り返し\") {\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    function emptyBoxLoopDragEnter(e) {\r\n        if (props.currentDraggedCommand === \"繰り返し\") {\r\n            e.preventDefault();\r\n            e.target.className += ' pg-l-empty-loop-hovered';\r\n        }\r\n    }\r\n\r\n    function emptyBoxLoopDragLeave(e) {\r\n        e.target.className = 'pg-l-empty-loop';\r\n    }\r\n\r\n    function emptyBoxLoopDragDrop(e) {\r\n        const indexArr = e.target.id.split('-')\r\n        indexArr.shift()\r\n        let tmp = [...props.loopData]\r\n        if (props.currentDraggedCommand === \"繰り返し\") {\r\n            tmp.push([[indexArr[0], indexArr[1]], [indexArr[0], indexArr[1]], 2])\r\n            props.setLoopData(tmp)\r\n            if (!props.isMute) {\r\n                let audio = new Audio(soundfile2);\r\n                audio.play();\r\n            }\r\n        } \r\n    }\r\n\r\n    const resizeLoop = (e, direction) => {\r\n        const indexArr = e.currentTarget.parentNode.parentNode.id.split('-')\r\n        indexArr.shift()\r\n        let tmp = [...props.loopData]\r\n        let mainItemIndex\r\n        tmp.forEach(loop => {\r\n            if (loop[0][0] === indexArr[0] && loop[0][1] === indexArr[1]) {\r\n                mainItemIndex = tmp.indexOf(loop)\r\n            }\r\n        })\r\n        let isDirectionAvailable = true\r\n        switch(direction) {\r\n            case \"top-up\":\r\n                tmp.forEach(loop => {\r\n                    if ((tmp.indexOf(loop) !== mainItemIndex) && (loop[1][0] === tmp[mainItemIndex][0][0] && loop[1][1] === tmp[mainItemIndex][0][1])) {\r\n                        isDirectionAvailable = false\r\n                    }\r\n                })\r\n                if (isDirectionAvailable && parseFloat(tmp[mainItemIndex][0][1]) >= 1) {\r\n                    tmp[mainItemIndex][0][1] = (parseFloat(tmp[mainItemIndex][0][1]) - 1).toString()\r\n                }\r\n                break\r\n            case \"top-down\":\r\n                if (tmp[mainItemIndex][0][1] !== tmp[mainItemIndex][1][1]) {\r\n                    tmp[mainItemIndex][0][1] = (parseFloat(tmp[mainItemIndex][0][1]) + 1).toString()\r\n                }\r\n                break\r\n            case \"bottom-up\":\r\n                if (tmp[mainItemIndex][0][1] !== tmp[mainItemIndex][1][1]) {\r\n                    tmp[mainItemIndex][1][1] = (parseFloat(tmp[mainItemIndex][1][1]) - 1).toString()\r\n                }\r\n                break\r\n            case \"bottom-down\":\r\n                for (let loop of tmp) {\r\n                    if ((tmp.indexOf(loop) !== mainItemIndex) && (loop[0][0] === tmp[mainItemIndex][1][0] && loop[0][1] === tmp[mainItemIndex][1][1])) {\r\n                        isDirectionAvailable = false\r\n                    }\r\n                }\r\n                let rowLength = props.programData[tmp[mainItemIndex][1][0]].length\r\n                if (isDirectionAvailable && parseFloat(tmp[mainItemIndex][1][1]) < (rowLength - 1)) {\r\n                    tmp[mainItemIndex][1][1] = (parseFloat(tmp[mainItemIndex][1][1]) + 1).toString()\r\n                }\r\n                break\r\n            default:\r\n                break \r\n        }\r\n        props.setLoopData(tmp)\r\n    }\r\n    // -------\r\n    function addGroupDragOver(e) {\r\n        if (props.currentDraggedCommand === \"動作グループを追加\") {\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    function addGroupDragEnter(e) {\r\n        e.currentTarget.style.height = \"30px\"\r\n        e.currentTarget.querySelector(\".add-row-plus-cont\").style.display = \"flex\"\r\n    }\r\n    \r\n    function addGroupDragLeave(e) {\r\n        e.currentTarget.style.height = \"0.2rem\"\r\n    }\r\n    \r\n    function addGroupDragDrop(e) {\r\n        let tmp = [...props.programData]\r\n        if (tmp.length <= 29) {\r\n\r\n            const indexArr = e.currentTarget.id.split('-')\r\n            indexArr.shift()\r\n            if (props.currentDraggedCommand === \"動作グループを追加\") {\r\n                let emptyGroup = [[]]\r\n                for (let z = 0; z < props.jiku; z++) emptyGroup[0].push([]);\r\n                tmp.splice((indexArr[0]+1), 0, emptyGroup); \r\n                props.setProgramData(tmp)\r\n            } \r\n            e.currentTarget.style.height = \"0.2rem\"\r\n        } else {\r\n            alert(\"Maximum motion group number is 30\")\r\n        }\r\n    }\r\n\r\n    const dousaBoxRef = useRef()\r\n\r\n    const dataToHTML = (programData) => {\r\n        let pg_l_arr = [<div className=\"pg-l-empty pglemp0\" key={\"first-pg-l-empty-box\"}></div>]\r\n        let main_grid = []\r\n        let jiku_i = 1\r\n        while (jiku_i <= props.jiku) {\r\n            const jiku_num = jiku_i\r\n            if (jiku_num === 1) {\r\n                main_grid.push(\r\n                <div className=\"jiku-number unselectable\" id={\"jiku-\"+jiku_num.toString()} key={\"jiku\"+jiku_num}>\r\n                    <div className=\"add-jiku-left\" id={\"addJiku-\"+jiku_num} onClick={(e) => addJiku(e)}>\r\n                        <div className=\"add-jiku-plus-cont\">\r\n                            <i className=\"fas fa-plus\"></i>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"add-jiku-right\" id={\"addJiku-\"+(jiku_num+1)} onClick={(e) => addJiku(e)}>\r\n                        <div className=\"add-jiku-plus-cont\">\r\n                            <i className=\"fas fa-plus\"></i>\r\n                        </div>\r\n                    </div>\r\n                    <i className=\"fas fa-arrow-alt-circle-left move-jiku\" onClick={(e) => moveJiku(e, \"left\")}></i>\r\n                    <p>\r\n                        Axis #{jiku_num}<i className=\"fas fa-trash trash-jiku\" onClick={(e) => trashJiku(e)}></i>\r\n                    </p>\r\n                    <i className=\"fas fa-arrow-alt-circle-right move-jiku\" onClick={(e) => moveJiku(e, \"right\")}></i>\r\n                </div>)\r\n            } else if (jiku_num === 15) {\r\n                main_grid.push(<div className=\"jiku-number unselectable\" id={\"jiku-\"+jiku_num.toString()} key={\"jiku\"+jiku_num}><i className=\"fas fa-arrow-alt-circle-left move-jiku\" onClick={(e) => moveJiku(e, \"left\")}></i><p>Axis #{jiku_num}<i className=\"fas fa-trash trash-jiku\" onClick={(e) => trashJiku(e)}></i></p><i className=\"fas fa-arrow-alt-circle-right move-jiku\" onClick={(e) => moveJiku(e, \"right\")}></i></div>)\r\n            } else {\r\n                main_grid.push(<div className=\"jiku-number unselectable\" id={\"jiku-\"+jiku_num.toString()} key={\"jiku\"+jiku_num}><div className=\"add-jiku-right\" id={\"addJiku-\"+(jiku_num+1)} onClick={(e) => addJiku(e)}><div className=\"add-jiku-plus-cont\"><i className=\"fas fa-plus\"></i></div></div><i className=\"fas fa-arrow-alt-circle-left move-jiku\" onClick={(e) => moveJiku(e, \"left\")}></i><p>Axis #{jiku_num}<i className=\"fas fa-trash trash-jiku\" onClick={(e) => trashJiku(e)}></i></p><i className=\"fas fa-arrow-alt-circle-right move-jiku\" onClick={(e) => moveJiku(e, \"right\")}></i></div>)\r\n            }\r\n            jiku_i += 1\r\n        }\r\n        main_grid.push(<div className=\"empty-right-box\" key={\"empRbox-0firrrst\"}></div>)\r\n        main_grid.push(<div className=\"grid-line\" style={{gridColumn:\"1/\"+(props.jiku+1)}} key={\"first-grid-line-key\"}></div>)\r\n        main_grid.push(<div className=\"empty-right-box\" key={\"empRbox-ggggllllliiinnneeee\"}></div>)\r\n        let dousa_group_i = 0\r\n        for (let dousa_group of programData) {\r\n            pg_l_arr.push(<div className=\"pg-l-empty pglempgroup\" key={\"pglempty\"+dousa_group_i}></div>)\r\n            main_grid.push(<div className=\"dousa-group-kaishi unselectable\" style={{gridColumn:\"1/\"+(props.jiku+1)}} key={\"dousagroup-\"+dousa_group_i} id={\"dousaGroup-\"+dousa_group_i}><p>Start motion group #{dousa_group_i+1}</p><i className=\"fas fa-trash\" onClick={(e) => trashGroup(e, props.programData, props.setProgramData, props.loopData, props.setLoopData)}></i></div>)\r\n            main_grid.push(<div className=\"empty-right-box\" key={\"empRbox-\"+dousa_group_i}></div>)\r\n            let dontPutEmp = []\r\n            let dousa_row_i = 0\r\n            for (let dousa_row of dousa_group) {\r\n                let loopCount\r\n                props.loopData.forEach(loop => {\r\n                    if (loop[0][0] === dousa_group_i.toString() && loop[0][1] === dousa_row_i.toString()) {\r\n                        loopCount = loop[2]\r\n                        let loopHeight = loop[1][1] - loop[0][1] + 1\r\n                        let loopStyleHeight = loopHeight * 2.3 + ((loopHeight-1) * (0.2 + 0.4))\r\n                        for (let z = 0; z < loopHeight; z++) dontPutEmp.push(\"loop\");\r\n                        let dragArrows = [<div className=\"loop-drag-top\" key={\"loopdragtop\"}><div onClick={(e) => resizeLoop(e, \"top-up\")}><i className=\"fas fa-arrow-alt-circle-up\"></i></div><div onClick={(e) => resizeLoop(e, \"top-down\")}><i className=\"fas fa-arrow-alt-circle-down\"></i></div></div>,<div className=\"loop-drag-bottom\" key={\"loop-drag-bottom\"}><div onClick={(e) => resizeLoop(e, \"bottom-up\")}><i className=\"fas fa-arrow-alt-circle-up\"></i></div><div onClick={(e) => resizeLoop(e, \"bottom-down\")}><i className=\"fas fa-arrow-alt-circle-down\"></i></div></div>]\r\n                        if (loop[0][1] === loop[1][1]) {\r\n                            dragArrows = [<div className=\"loop-drag-top\" key={\"loopdragtop\"}><div onClick={(e) => resizeLoop(e, \"top-up\")}><i className=\"fas fa-arrow-alt-circle-up\"></i></div></div>,<div className=\"loop-drag-bottom\" key={\"loop-drag-bottom\"}><div onClick={(e) => resizeLoop(e, \"bottom-down\")}><i className=\"fas fa-arrow-alt-circle-down\"></i></div></div>]\r\n                        }\r\n                        const loopId = \"loop-\"+dousa_group_i+\"-\"+dousa_row_i\r\n                        pg_l_arr.push(\r\n                        <div className=\"pg-l-loop unselectable\" style={{height:loopStyleHeight+\"rem\"}} id={loopId} key={\"pglloop\"+dousa_row}>\r\n                            {dragArrows.map(dragArrow => {return dragArrow})}\r\n                            <p className=\"loop-title\" onClick={() => showTypeData(true, loopId)}>Loop x {loopCount}</p>\r\n                            <i className=\"fas fa-trash trash-block\" onClick={(e) => trashLoop(e, props.loopData, props.setLoopData)}></i>\r\n                        </div>)\r\n                    }\r\n                })\r\n                if (dontPutEmp.length === 0) {\r\n                    pg_l_arr.push(<div className=\"pg-l-empty-loop\" id={\"emptyloop-\"+dousa_group_i+\"-\"+dousa_row_i} onDragOver={(e) => emptyBoxLoopDragOver(e)} onDragEnter={(e) => emptyBoxLoopDragEnter(e)} onDragLeave={(e) => emptyBoxLoopDragLeave(e)} onDrop={(e) => emptyBoxLoopDragDrop(e)} key={\"pglemploop-\"+dousa_group_i+\"-\"+dousa_row_i}></div>)\r\n                } else {\r\n                    dontPutEmp.shift()\r\n                }\r\n                if (dousa_row_i === 0) {\r\n                    main_grid.push(<div ref={addRowRef} key={\"addrow0\"+dousa_group_i+\"-\"+dousa_row_i} id={\"addRow-\"+dousa_group_i+\"-0\"} onClick={(e) => addRow(e)} className=\"pg-add-row\" style={{gridColumn:\"1/\"+(props.jiku+1)}}><div className=\"add-row-plus-cont\"><i className=\"fas fa-plus\"></i></div></div>)\r\n                    main_grid.push(<div className=\"empty-right-box\" key={\"empRbox-\"+dousa_group_i+\"-\"+dousa_row_i}></div>)\r\n                }\r\n                let dousa_i = 0\r\n                for (let dousa of dousa_row) {\r\n                    if (dousa.length !== 0) {\r\n                        let noValueArr = []\r\n                        dousa[2].forEach(value => {if (value.includes(\"Enter value here\")) noValueArr.push(\"nope\")})\r\n                        const dousaId = \"dousa-\"+dousa_group_i+\"-\"+dousa_row_i+\"-\"+dousa_i\r\n                        const jikuOfDousa = dousa_i\r\n                        let dousaName = \"\"\r\n                        switch (dousa[0]) {\r\n                            case \"位置決め\":\r\n                                dousaName = \"PTP\"\r\n                                break\r\n                            case \"押付け\":\r\n                                dousaName = \"Push\"\r\n                                break\r\n                            case \"タイマ\":\r\n                                dousaName = \"Timer\"\r\n                                break\r\n                            case \"位置決め+\":\r\n                                dousaName = \"PTP+\"\r\n                                break\r\n                            case \"押付け+\":\r\n                                dousaName = \"Push+\"\r\n                                break\r\n                            case \"入力点からの実行\":\r\n                                dousaName = \"Exec.\"\r\n                                break\r\n                            default:\r\n                                dousaName = \"PTP\"\r\n                                break\r\n                        }\r\n                        if (noValueArr.length > 0) {\r\n                            main_grid.push(<div ref={dousaBoxRef} className=\"dousa-box unselectable\" draggable=\"true\" onDragStart={(e) => emptyBoxDragStart(e)} onDragEnd={(e) => emptyBoxDragEnd(e)} onMouseEnter={(e) => props.setCurrentDraggedCommand(e.currentTarget.id)} key={dousa_group_i+\"dousabox\"+dousa_row_i+\"-\"+dousa_i} id={dousaId}><div className='no-value-circle'></div><p className='dousa-title' onClick={() => showTypeData(false, dousaId, jikuOfDousa, dousa[0], dousa[1])} >{dousaName}<span style={{marginRight:'0.2rem'}}></span>#{dousa[1]}</p><i className=\"fas fa-trash\" onClick={(e) => trashInput(e, props.programData, props.setProgramData)}></i></div>)\r\n                        } else {\r\n                            main_grid.push(<div ref={dousaBoxRef} className=\"dousa-box unselectable\" draggable=\"true\" onDragStart={(e) => emptyBoxDragStart(e)} onDragEnd={(e) => emptyBoxDragEnd(e)} onMouseEnter={(e) => props.setCurrentDraggedCommand(e.currentTarget.id)} key={dousa_group_i+\"dousabox\"+dousa_row_i+\"-\"+dousa_i} id={dousaId}><p className='dousa-title' onClick={() => showTypeData(false, dousaId, jikuOfDousa, dousa[0], dousa[1])} >{dousaName}<span style={{marginRight:'0.2rem'}}></span>#{dousa[1]}</p><i className=\"fas fa-trash\" onClick={(e) => trashInput(e, props.programData, props.setProgramData)}></i></div>)\r\n                        }\r\n                    } else {\r\n                        // main_grid.push(<div className=\"dousa-box\"></div>)\r\n                        main_grid.push(<div ref={pgEmptyBox} key={dousa_group_i+\"emptybox\"+dousa_row_i+\"-\"+dousa_i} onDragOver={(e) => emptyBoxDragOver(e)} onDragEnter={(e) => emptyBoxDragEnter(e)} onDragLeave={(e) => emptyBoxDragLeave(e)} onDrop={(e) => emptyBoxDragDrop(e)} className=\"pg-empty-box\" id={\"dousa-\"+dousa_group_i+\"-\"+dousa_row_i+\"-\"+dousa_i}></div>)\r\n                    } \r\n                    dousa_i += 1\r\n                }\r\n                main_grid.push(\r\n                    <div className=\"trash-row-right-box\" key={\"trashR-\"+dousa_group_i+\"-\"+dousa_row_i} id={\"trashRow-\"+dousa_group_i+\"-\"+(dousa_row_i)}>\r\n                        <i onClick={(e) => trashRow(e, props.programData, props.setProgramData, props.loopData, props.setLoopData)} className=\"fas fa-trash\"></i>\r\n                        <div className='move-row-cont'><i className='fas fa-arrow-alt-circle-up move-row-up' onClick={(e) => moveRow(e, \"up\")}></i><i className='fas fa-arrow-alt-circle-down move-row-down' onClick={(e) => moveRow(e, \"down\")}></i></div>\r\n                    </div>)\r\n                if (dousa_row_i !== (dousa_group.length-1)) {\r\n                    main_grid.push(<div ref={addRowRef} key={\"addrow\"+dousa_group_i+\"-\"+dousa_row_i} id={\"addRow-\"+dousa_group_i+\"-\"+(dousa_row_i+1)} onClick={(e) => addRow(e)} className=\"pg-add-row\" style={{gridColumn:\"1/\"+(props.jiku+1)}}><div className=\"add-row-plus-cont\"><i className=\"fas fa-plus\"></i></div></div>)\r\n                    main_grid.push(<div className=\"empty-right-box\" key={\"empRboxaddR-\"+dousa_group_i+\"-\"+dousa_row_i}></div>)\r\n                } else {\r\n                    main_grid.push(<div ref={addRowRef} key={\"addrow\"+dousa_group_i+\"-\"+dousa_row_i} id={\"addRow-\"+dousa_group_i+\"-\"+(dousa_row_i+1)} onClick={(e) => addRow(e)} onDragOver={(e) => addGroupDragOver(e)} onDragEnter={(e) => addGroupDragEnter(e)} onDragLeave={(e) => addGroupDragLeave(e)} onDrop={(e) => addGroupDragDrop(e)} className=\"pg-add-row\" style={{gridColumn:\"1/\"+(props.jiku+1),height:\"0.4rem\"}}><div className=\"add-row-plus-cont\"><i className=\"fas fa-plus\"></i></div></div>)\r\n                    main_grid.push(<div className=\"empty-right-box\" key={\"empRboxaddR-\"+dousa_group_i+\"-\"+dousa_row_i}></div>)\r\n                }\r\n                dousa_row_i += 1\r\n            }\r\n            dousa_group_i += 1\r\n        }\r\n\r\n        return (\r\n            <div className=\"program-grid\">\r\n                <div className=\"pg-left\">{pg_l_arr}</div>\r\n                <div className=\"program-main-grid\" style={{gridTemplateColumns:\"repeat(\"+props.jiku+\", 3fr) 1fr\"}}>{main_grid}</div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    // initially have 動作グループ1\r\n    return(\r\n        <div className=\"program-block\">\r\n            {dataToHTML(props.programData)}\r\n            <div className=\"enter-button\">\r\n                <Button variant=\"contained\" onClick={() => pressRun(toCML(props.programData, props.loopData, props.isNyuryokuShingou, props.tkData))}>Run</Button>\r\n                <div style={{height:10,width:30}}></div>\r\n                <Button variant=\"contained\" onClick={() => stop()}>Stop</Button>\r\n                <div style={{height:10,width:30}}></div>\r\n                <Button variant=\"contained\" onClick={() => props.setCmlOutput(toCML(props.programData, props.loopData, props.isNyuryokuShingou, props.tkData))}>Convert to CML</Button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport const TypeDataInDousaEng = (props) => {\r\n    // let dousaType = props.dousaType\r\n    // let dousaNum = props.dousaNum\r\n    // let parentId = props.parentId\r\n    const popupRef = useRef()\r\n    const tkData = props.tkData\r\n    // --\r\n    let indexArr = props.parentId.split('-')\r\n    indexArr.shift()\r\n    const jikuNum = parseFloat(indexArr[2])\r\n    // -\r\n    let tmp = [...props.programData]\r\n    // --\r\n    const closeTypeData = () => {\r\n        props.setInputBoxType(\"none\")\r\n    }\r\n\r\n    let subTanni = \"initial\"\r\n    if (tkData[jikuNum].kikou !== \"initial\") {\r\n        if (tkData[jikuNum].kikou === \"インデックステーブル\") {\r\n            subTanni = \"°\"\r\n        } else {\r\n            subTanni = \"mm\"\r\n        }\r\n    }\r\n\r\n    const ichigimeData = {\r\n        bangouRange: 250,\r\n        inputForm: subTanni===\"initial\" ? [\r\n            [\"Speed Data\", [\"100pps\"], \"\"],\r\n            [\"Accel. Data\", [\"kpps\\u00b2\"], \"\"],\r\n            [\"Position Data\", [\"Pulse\"], \"\"],\r\n        ] : [\r\n            [\"Speed Data\", [\"100pps\", subTanni+\"/s\"], \"\"],\r\n            [\"Accel. Data\", [\"kpps\\u00b2\", subTanni+\"/s\\u00b2\"], \"\"],\r\n            [\"Position Data\", [\"Pulse\", subTanni], \"\"],\r\n        ]\r\n    }\r\n    const incrementalIchigimeData = {\r\n        bangouRange: 250,\r\n        inputForm: subTanni===\"initial\" ? [\r\n            [\"Speed Data\", [\"100pps\"], \"\"],\r\n            [\"Accel. Data\", [\"kpps\\u00b2\"], \"\"],\r\n            [\"Position Data\", [\"Pulse\"], \"\"],\r\n        ] : [\r\n            [\"Speed Data\", [\"100pps\", subTanni+\"/s\"], \"\"],\r\n            [\"Accel. Data\", [\"kpps\\u00b2\", subTanni+\"/s\\u00b2\"], \"\"],\r\n            [\"Position Data\", [\"Pulse\", subTanni], \"\"],\r\n        ]\r\n    }\r\n    const oshitukeData = {\r\n        bangouRange: 250,\r\n        inputForm: subTanni===\"initial\" ? [\r\n            [\"Speed Data\", [\"100pps\"], \"\"],\r\n            [\"Accel. Data\", [\"kpps\\u00b2\"], \"\"],\r\n            [\"Position Data\", [\"Pulse\"], \"\"],\r\n        ] : [\r\n            [\"Speed Data\", [\"100pps\", subTanni+\"/s\"], \"\"],\r\n            [\"Accel. Data\", [\"kpps\\u00b2\", subTanni+\"/s\\u00b2\"], \"\"],\r\n            [\"Position Data\", [\"Pulse\", subTanni], \"\"],\r\n        ]\r\n    }\r\n    const incrementalOshitukeData = {\r\n        bangouRange: 250,\r\n        inputForm: subTanni===\"initial\" ? [\r\n            [\"Speed Data\", [\"100pps\"], \"\"],\r\n            [\"Accel. Data\", [\"kpps\\u00b2\"], \"\"],\r\n            [\"Position Data\", [\"Pulse\"], \"\"],\r\n        ] : [\r\n            [\"Speed Data\", [\"100pps\", subTanni+\"/s\"], \"\"],\r\n            [\"Accel. Data\", [\"kpps\\u00b2\", subTanni+\"/s\\u00b2\"], \"\"],\r\n            [\"Position Data\", [\"Pulse\", subTanni], \"\"],\r\n        ]\r\n    }\r\n    const timerData = {\r\n        bangouRange: 5,\r\n        inputForm: [\r\n            [\"Timer Data\", [\"msec\"], \"\"],\r\n        ]\r\n    }\r\n\r\n    const nyuryokutenData = {\r\n        bangouRange: 4,\r\n    }\r\n\r\n    let dataFormat\r\n    switch(props.dousaType) {\r\n        case \"位置決め\":\r\n            dataFormat = ichigimeData\r\n            break\r\n        case \"押付け\":\r\n            dataFormat = oshitukeData\r\n            break\r\n        case \"タイマ\":\r\n            dataFormat = timerData\r\n            break\r\n        case \"位置決め+\":\r\n            dataFormat = incrementalIchigimeData\r\n            break\r\n        case \"押付け+\":\r\n            dataFormat = incrementalOshitukeData\r\n            break\r\n        case \"入力点からの実行\":\r\n            dataFormat = nyuryokutenData\r\n            break\r\n        default:\r\n            dataFormat = ichigimeData\r\n    }\r\n\r\n    const DousaInputBox = (props) => {\r\n        // props: dataFormat, numdropdown params\r\n        const dataFormat = props.dataFormat\r\n\r\n        const setTypeData = () => {\r\n            let isAllNumber = []\r\n            popupRef.current.querySelectorAll('.type-data-input').forEach(input => {\r\n                if (isNaN(parseFloat(input.value))) {\r\n                    isAllNumber.push(\"NAN\")\r\n                }\r\n            })\r\n            if (isAllNumber.length === 0) {\r\n                let tmp = [...props.programData]\r\n                let valueArr = []\r\n                let inputs = popupRef.current.querySelectorAll(\".type-data-input\")\r\n                let tanniSelectors = popupRef.current.querySelectorAll(\".select-tanni\")\r\n                let i = 0\r\n                while (i < inputs.length) {\r\n                    valueArr.push([inputs[i].value, tanniSelectors[i].value])\r\n                    i++\r\n                }\r\n                for (let dousa_group of tmp) {\r\n                    for (let dousa_row of dousa_group) {\r\n                        let dousa = dousa_row[props.jiku]\r\n                        if (dousa.length > 0) {\r\n                            // I don't get this code\r\n                            // if (props.dousaType !== (\"位置決め\"&&\"押付け\")) {\r\n                            // if (props.dousaType !== (\"位置決め\"||\"押付け\")) {\r\n                            //     if (dousa[1] === props.dousaNum && dousa[0] === props.dousaType) {\r\n                            //         dousa[2] = valueArr\r\n                            //     }\r\n                            // } else {\r\n                            //     if (dousa[1] === props.dousaNum) {\r\n                            //         dousa[2] = valueArr\r\n                            //     }\r\n                            // }\r\n                            if (dousa[1] === props.dousaNum && dousa[0] === props.dousaType) {\r\n                                dousa[2] = valueArr\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                tmp[parseFloat(indexArr[0])][parseFloat(indexArr[1])][parseFloat(indexArr[2])][2] = valueArr\r\n                props.setProgramData(tmp)\r\n                // --\r\n                closeTypeData()\r\n            } else {\r\n                isAllNumber = []\r\n                alert('Enter value here') \r\n            }\r\n        } \r\n    \r\n        return (\r\n            <div className=\"typeDataInDousa\" ref={popupRef}>\r\n                <div className=\"close-typedata\"><i onClick={() => closeTypeData()} className=\"fas fa-times-circle type-times-circle\"></i></div>\r\n                <div className='typedata-input-line' key={\"input-num-line\"}>\r\n                    <p className='typedata-var'>#</p>\r\n                    {\r\n                        props.dousaType === \"入力点からの実行\" ? \r\n                            <NumDropDown range={dataFormat.bangouRange} jiku={props.jiku} dousaType={props.dousaType} dousaNum={props.dousaNum} popupRef={props.popupRef} programData={props.programData} setProgramData={props.setProgramData} indexArr={props.indexArr}/>\r\n                            : <div className='current-num-container'><p className='current-num'>{ [...props.programData][parseFloat(indexArr[0])][parseFloat(indexArr[1])][parseFloat(indexArr[2])][1] }</p></div>\r\n                    }\r\n                </div>\r\n                {\r\n                    props.dousaType === \"入力点からの実行\" ? <></>\r\n                    : dataFormat.inputForm.map(inputLine => {\r\n                        return (\r\n                            <div className=\"typedata-input-line\" key={inputLine[0]}>\r\n                                <p className=\"typedata-var\">{inputLine[0]}</p>\r\n                                <DataInput index={dataFormat.inputForm.indexOf(inputLine)} tanniArr={inputLine[1]} />\r\n                                <p>{inputLine[2]}</p>\r\n                            </div>\r\n                        )\r\n                    }) \r\n                }\r\n                <Button className=\"type-data-button\" variant=\"contained\" onClick={() => setTypeData()}>OK</Button>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const DataInput = (props) => {\r\n        // const data = [100, \"pps\"]\r\n        const index = props.index\r\n        const tanniArr = props.tanniArr\r\n        const [value, setValue] = useState(tmp[parseFloat(indexArr[0])][parseFloat(indexArr[1])][parseFloat(indexArr[2])][2][index][0])\r\n        const [tanniState, setTanniState] = useState(tmp[parseFloat(indexArr[0])][parseFloat(indexArr[1])][parseFloat(indexArr[2])][2][index][1])\r\n        // ---\r\n\r\n        return (\r\n            <>\r\n                {value.toString().includes('Enter value here') ? \r\n                    <input className=\"type-data-input\" required placeholder={value} onChange={(e) => setValue(e.target.value)} />\r\n                    // : <input className=\"type-data-input\" required value={value} onChange={(e) => setValue(e.target.value)} />\r\n                    : <input className=\"type-data-input\" required defaultValue={value} onChange={(e) => setValue(e.target.value)} />\r\n                }\r\n                <div className=\"type-data-tanni\">\r\n                    <select className='select-tanni' value={tanniState} onChange={(e) => setTanniState(e.target.value)} >\r\n                        { tanniArr.map(tanni => {\r\n                            return <option key={tanni} value={tanni}>{tanni}</option>\r\n                        }) }\r\n                    </select>\r\n                </div>\r\n            </>\r\n        )\r\n    }\r\n\r\n    return (<DousaInputBox dataFormat={dataFormat} jiku={props.jiku} dousaType={props.dousaType} dousaNum={props.dousaNum} popupRef={popupRef} programData={props.programData} setProgramData={props.setProgramData} indexArr={indexArr}/>)\r\n}\r\n\r\nexport const LoopInputBoxEng = (props) => {\r\n    // props: parentId, loopData, setLoopData\r\n    const popupRef = useRef()\r\n    let indexArr = props.parentId.split('-')\r\n    indexArr.shift()\r\n    // --\r\n    let tmp = [...props.loopData]\r\n    const [value, setValue] = useState(tmp[parseFloat(indexArr[0])][2])\r\n    // --\r\n    const closeTypeData = () => {\r\n        props.setInputBoxType(\"none\")\r\n    }\r\n\r\n    const setTypeData = () => {\r\n        let isAllNumber = []\r\n        if (isNaN(popupRef.current.querySelector('.type-data-input').value)) {\r\n                isAllNumber.push(\"NAN\")\r\n        }\r\n        if (isAllNumber.length === 0) {\r\n            let tmp = [...props.loopData]\r\n            let value = popupRef.current.querySelector(\".type-data-input\").value\r\n            tmp[parseFloat(indexArr[0])][2] = value\r\n            props.setLoopData(tmp)\r\n            // --\r\n            closeTypeData()\r\n        } else {\r\n            isAllNumber = []\r\n            alert('Enter value here') \r\n        }\r\n    } \r\n\r\n    return (\r\n        <div className=\"typeDataInDousa\" ref={popupRef}>\r\n            <div className=\"close-typedata\"><i onClick={() => closeTypeData()} className=\"fas fa-times-circle type-times-circle\"></i></div>\r\n            <div className=\"typedata-input-line\">\r\n                <input className=\"type-data-input\" required value={value} onChange={(e) => setValue(e.target.value)} />\r\n                <p>回繰り返す</p>\r\n            </div>\r\n            <Button className=\"type-data-button\" variant=\"contained\" onClick={() => setTypeData()}>OK</Button>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst NumDropDown = (props) => {\r\n    // props: programData, setProgramData, dataType, dataNum, popupRef, jiku, indexArr, range\r\n    const popupRef = props.popupRef\r\n    const indexArr = props.indexArr\r\n    let tmp = [...props.programData]\r\n    const [currentNum, setCurrentNum] = useState(tmp[parseFloat(indexArr[0])][parseFloat(indexArr[1])][parseFloat(indexArr[2])][1])\r\n    const numItemRef = useRef()\r\n    const currentNumRef = useRef()\r\n    \r\n    const selectItem = (e) => {\r\n        const value = parseFloat(e.currentTarget.id.split(\"-\")[2])\r\n        setCurrentNum(value)\r\n        numItemRef.current.style.display = \"none\"\r\n        let sameDataArr = []\r\n        for (let dousa_group of tmp) {\r\n            for (let dousa_row of dousa_group) {\r\n                let dousa = dousa_row[props.jiku]\r\n                if (dousa[1] === value && dousa[0] === props.dousaType) {\r\n                    sameDataArr.push(dousa[2])\r\n                }\r\n            }\r\n        }\r\n        if (sameDataArr.length > 0) {\r\n            tmp[parseFloat(indexArr[0])][parseFloat(indexArr[1])][parseFloat(indexArr[2])][2] = sameDataArr[0]\r\n            let inputs = popupRef.current.querySelectorAll(\".type-data-input\")\r\n            let tanniSelectors = popupRef.current.querySelectorAll(\".select-tanni\")\r\n            let i = 0\r\n            while (i < inputs.length) {\r\n                inputs[i].value = sameDataArr[0][i][0]\r\n                tanniSelectors[i].value = sameDataArr[0][i][1]\r\n                i++\r\n            }\r\n        }\r\n        tmp[parseFloat(indexArr[0])][parseFloat(indexArr[1])][parseFloat(indexArr[2])][1] = value\r\n        props.setProgramData(tmp)\r\n    }\r\n    const getNumItems = () => {\r\n        let res = []\r\n        let i = 1\r\n        while (i <= props.range) {\r\n            res.push(<div className='num-dropdown-item' key={i} id={\"num-dropdown-\"+i} onClick={(e) => selectItem(e)}><p>{i}</p></div>)\r\n            i += 1\r\n        }\r\n        return res\r\n    }\r\n    const showItems = () => {\r\n        let isItemsShown = numItemRef.current.style.display !== \"block\" ? false : true\r\n        if (!isItemsShown) {\r\n            numItemRef.current.style.display = \"block\"\r\n        } else {\r\n            numItemRef.current.style.display = \"none\"\r\n        }\r\n    }\r\n    return (\r\n        <div className='num-dropdown'>\r\n            <div className='currentNum-container' onClick={() => showItems()}><p ref={currentNumRef} className='currentNum'>{currentNum}</p><i className='fas fa-caret-down'></i></div>\r\n            <div ref={numItemRef} className='num-dropdown-item-container'>{getNumItems()}</div>\r\n        </div>\r\n    )\r\n}","import { Button } from \"@mui/material\"\r\nimport { useEffect, useRef, useState } from \"react\"\r\n\r\n// ------------------------------------\r\nexport const WizardJikuEng = (props) => {\r\n\r\n    const params = props.params\r\n    const tkData = params.tannikannsannData\r\n    const [input, setInput] = useState(params.history.length >= 1 ? params.history[0][1] : [])\r\n    const checkBoxRef = useRef()\r\n\r\n    useEffect(() => {\r\n        input.forEach(num => {\r\n            checkBoxRef.current.querySelector('#jiku-'+num).checked = true\r\n        })\r\n    }, [input])\r\n\r\n    const jikuCheckBoxContainer = () => {\r\n        let res = []\r\n        let i = 1\r\n        while (i<=params.jiku) {\r\n            const num = i\r\n            res.push(\r\n                <div className=\"jiku-input-container\" key={num+\"jiku-input\"}>\r\n                    <input type=\"checkbox\" key={num+\"input\"} onChange={(e) => changeInput(e, num)} id={\"jiku-\"+num} name=\"jiku-sentaku\"/>\r\n                    <label htmlFor={\"jiku-\"+num} key={num+\"label\"}>Axis #{num}</label>\r\n                </div>\r\n            )\r\n            i += 1\r\n        }\r\n        return res\r\n    }\r\n\r\n    const changeInput = (e, num) => {\r\n        const isChecked = e.currentTarget.checked\r\n        let tmp = [...input]\r\n        if (isChecked && !input.includes(num)) {\r\n            tmp.push(num)\r\n        } else {\r\n            const index = tmp.indexOf(num);\r\n            if (index > -1) {\r\n                tmp.splice(index, 1);\r\n            }\r\n        }\r\n        setInput(tmp)\r\n    }\r\n\r\n    const goNext = () => {\r\n        let isCheckedArr = []\r\n        checkBoxRef.current.querySelectorAll('input').forEach(checkBox => {\r\n            if (checkBox.checked === true) {\r\n                isCheckedArr.push(\"true\")\r\n            }\r\n        })\r\n        if (isCheckedArr.length >= 1) {\r\n            let tmp = [...params.history]\r\n            if (tmp.length >= 1) {\r\n                tmp[0][1] = input\r\n            } else {\r\n                tmp.push([\"jiku\", input])\r\n            }\r\n            params.setHistory(tmp)\r\n            params.setWizardInput([\"kikou\", input])\r\n        } else {\r\n            alert(\"Select axis\")\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"tanni-wizard unselectable\">\r\n            <p className=\"tanni-wizard-title\">Select Axis</p>\r\n            <div ref={checkBoxRef} className=\"tanni-wizard-selector tanni-jiku\">\r\n                {jikuCheckBoxContainer()}\r\n            </div>\r\n            <div className=\"tanni-wizard-buttons\">\r\n                <Button className=\"tanni-next\" variant=\"contained\" onClick={() => goNext()}>NEXT</Button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n// ------------------------------------\r\n\r\nexport const WizardKikouEng = (props) => {\r\n    const params = props.params\r\n    const tkData = params.tannikannsannData\r\n    const jikuMainNum = params.history[0][1][0]-1\r\n    const [input, setInput] = useState(params.history.length >= 2 ? params.history[1][1] : (tkData[jikuMainNum].kikou !== \"initial\" ? tkData[jikuMainNum].kikou : \"ボールねじ\"))\r\n    const radioRef = useRef()\r\n\r\n    useEffect(() => {\r\n        let arr = [\"ボールねじ\", \"ベルト駆動\", \"ラックアンドピニオン\", \"インデックステーブル\"]\r\n        let i = arr.indexOf(input) + 1\r\n        radioRef.current.querySelector('#kikou-'+i).checked = true\r\n    }, [input])\r\n\r\n    const goBack = () => {\r\n        params.setWizardInput([\"jiku\", params.history[0][1]])\r\n    }\r\n\r\n    const goNext = () => {\r\n        let isCheckedArr = []\r\n        radioRef.current.querySelectorAll('input').forEach(input => {\r\n            if (input.checked === true) {\r\n                isCheckedArr.push(\"true\")\r\n            }\r\n        })\r\n        if (isCheckedArr.length !== 1) {\r\n            alert('Select an application')\r\n        } else {\r\n            let tmp = [...params.history]\r\n            if (params.history.length === 1) {\r\n                tmp.push([\"kikou\", input])\r\n                if (input !== \"インデックステーブル\") {\r\n                    params.setWizardInput([\"susumiryou\", input])\r\n                } else {\r\n                    tmp.push([\"susumiryou\", 360, 360])\r\n                    params.setWizardInput([\"gensoku\", input])\r\n                }\r\n            } else {\r\n                tmp[1] = [\"kikou\", input]\r\n                if (input !== \"インデックステーブル\") {\r\n                    params.setWizardInput([\"susumiryou\", input])\r\n                } else {\r\n                    tmp[2] = [\"susumiryou\", 1]\r\n                    params.setWizardInput([\"gensoku\", input])\r\n                }\r\n            }\r\n            params.setHistory(tmp)\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"tanni-wizard unselectable\">\r\n            <p className=\"tanni-wizard-title\">Select Application</p>\r\n            <div ref={radioRef} className=\"tanni-wizard-selector tanni-kikou\">\r\n                <div>\r\n                    <input type=\"radio\" onClick={(e) => setInput(e.currentTarget.value)} id=\"kikou-1\" name=\"kikou-sentaku\" value=\"ボールねじ\"/>\r\n                    <label htmlFor=\"kikou-1\">Ball screw</label>\r\n                </div>\r\n                <div>\r\n                    <input type=\"radio\" onClick={(e) => setInput(e.currentTarget.value)} id=\"kikou-2\" name=\"kikou-sentaku\" value=\"ベルト駆動\" />\r\n                    <label htmlFor=\"kikou-2\">Belt drive</label>\r\n                </div>\r\n                <div>\r\n                    <input type=\"radio\" onClick={(e) => setInput(e.currentTarget.value)} id=\"kikou-3\" name=\"kikou-sentaku\" value=\"ラックアンドピニオン\" />\r\n                    <label htmlFor=\"kikou-3\">Rack and pinion</label>\r\n                </div>\r\n                <div>\r\n                    <input type=\"radio\" onClick={(e) => setInput(e.currentTarget.value)} id=\"kikou-4\" name=\"kikou-sentaku\" value=\"インデックステーブル\" />\r\n                    <label htmlFor=\"kikou-4\">Index table</label>\r\n                </div>\r\n            </div>\r\n            <div className=\"tanni-wizard-buttons\">\r\n                <Button className=\"tanni-back\" variant=\"contained\" onClick={() => goBack()}>BACK</Button>\r\n                <Button className=\"tanni-next\" variant=\"contained\" onClick={() => goNext()}>NEXT</Button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport const WizardSusumiryouEng = (props) => {\r\n    const params = props.params\r\n    const tkData = params.tannikannsannData\r\n    const jikuMainNum = params.history[0][1][0]-1\r\n    const mode = params.history[1][1]\r\n    let susumiryouText = \"\"\r\n    let susumiryouVar = Math.PI\r\n    const [input, setInput] = useState((params.history.length >= 3) ? parseFloat(params.history[2][2]) : tkData[jikuMainNum].susumiryou[0])\r\n\r\n    switch (mode) {\r\n        case \"ボールねじ\":\r\n            susumiryouText = \"Ball screw lead\"\r\n            susumiryouVar = 1\r\n            break\r\n        case \"ベルト駆動\":\r\n            susumiryouText = \"Pulley diameter\"\r\n            break\r\n        case \"ラックアンドピニオン\":\r\n            susumiryouText = \"Pinion diameter\"\r\n            break\r\n        default:\r\n            susumiryouText = \"Ball screw lead\"\r\n            break\r\n    }\r\n\r\n    const goNext = () => {\r\n        if (input !== \"\") {\r\n            let tmp = [...params.history]\r\n            if (params.history.length === 2) {\r\n                tmp.push([\"susumiryou\", Math.round((parseFloat(input)*susumiryouVar + Number.EPSILON) * 100) / 100, parseFloat(input)])\r\n            } else {\r\n                tmp[2] = [\"susumiryou\", Math.round((parseFloat(input)*susumiryouVar + Number.EPSILON) * 100) / 100, parseFloat(input)]\r\n            }\r\n            params.setHistory(tmp)\r\n            params.setWizardInput([\"gensoku\", input])\r\n        } else {\r\n            alert('Enter a value')\r\n        }\r\n    }\r\n\r\n    const goBack = () => {\r\n        let tmp = [...params.history]\r\n        let kikouValue = tmp[1][1]\r\n        params.setWizardInput([\"kikou\", kikouValue])\r\n    }\r\n\r\n    return (\r\n        <div className=\"tanni-wizard\">\r\n            <p className=\"tanni-wizard-title unselectable\">Travel distance per motor revolution</p>\r\n            <div className=\"tanni-wizard-selector tanni-susumi\">\r\n                <div className=\"susumi-1\">\r\n                    <p className='tanni-susumi-p'>{susumiryouText} : </p>\r\n                    {(params.history.length <= 2 && tkData[jikuMainNum].susumiryou[0]===0) ? \r\n                    <input type=\"text\" placeholder={0} onChange={(e) => setInput(e.currentTarget.value)}/>\r\n                    : <input type=\"text\" value={input} onChange={(e) => setInput(e.currentTarget.value)}/>\r\n                    }\r\n                    <p className='tanni-susumi-tanni'> mm</p>\r\n                </div>\r\n                <div className=\"susumi-2\">\r\n                    <p className='tanni-susumi-p'>Distance : <span>{Math.round((parseFloat(input)*susumiryouVar + Number.EPSILON) * 100) / 100}</span> mm</p>\r\n                </div>\r\n            </div>\r\n            <div className=\"tanni-wizard-buttons unselectable\">\r\n                <Button className=\"tanni-back\" variant=\"contained\" onClick={() => goBack()}>BACK</Button>\r\n                <Button className=\"tanni-next\" variant=\"contained\" onClick={() => goNext()}>NEXT</Button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport const WizardGensokuEng = (props) => {\r\n    const params = props.params\r\n    const tkData = params.tannikannsannData\r\n    const jikuMainNum = params.history[0][1][0]-1\r\n    // const [input, setInput] = useState((params.history.length >= 4) ? params.history[3][1] : tkData[jikuMainNum].gensoku)\r\n    const [input1, setInput1] = useState((params.history.length >= 4) ? params.history[3][1][0] : tkData[jikuMainNum].gensoku[0])\r\n    const [input2, setInput2] = useState((params.history.length >= 4) ? params.history[3][1][1] : tkData[jikuMainNum].gensoku[1])\r\n    const checkBoxRef = useRef()\r\n    const selectorRef = useRef()\r\n\r\n    useEffect(() => {\r\n        if (((params.history.length > 3) && (params.history[3][1][0] !== (1||\"\") || params.history[3][1][1] !== (1||\"\"))) || (tkData[jikuMainNum].gensoku[0]!==(1||\"\") || tkData[jikuMainNum].gensoku[1]!==(1||\"\"))) {\r\n            selectorRef.current.style.opacity = \"1\"\r\n            checkBoxRef.current.checked = \"true\"\r\n            selectorRef.current.querySelectorAll(\"input\").forEach(input => {\r\n                input.readOnly = false\r\n            })\r\n        }\r\n    })\r\n\r\n    const goNext = () => {\r\n        if ((input1 && input2) !== \"\") {\r\n            let tmp = [...params.history]\r\n            if (params.history.length === 3) {\r\n                tmp.push([\"gensoku\", [input1, input2]])\r\n            } else {\r\n                tmp[3] = [\"gensoku\", [input1, input2]]\r\n            }\r\n            params.setHistory(tmp)\r\n            params.setWizardInput([\"bunkai\", [input1, input2]])\r\n        } else {\r\n            alert(\"Enter a value\")\r\n        }\r\n    }\r\n\r\n    const goBack = () => {\r\n        if (params.history[1][1] !== \"インデックステーブル\") {\r\n            params.setWizardInput([\"susumiryou\", 0])\r\n        } else {\r\n            params.setWizardInput([\"kikou\", 0])\r\n        }\r\n    }\r\n\r\n    const handleToggle = (e) => {\r\n        if (e.currentTarget.checked) {\r\n            selectorRef.current.style.opacity = \"1\"\r\n            selectorRef.current.querySelectorAll(\"input\").forEach(input => {\r\n                input.readOnly = false\r\n            })\r\n        } else {\r\n            setInput1(1)\r\n            setInput2(1)\r\n            selectorRef.current.style.opacity = \"0.4\"\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"tanni-wizard unselectable\">\r\n            <div className=\"tanni-wizard-title gensoku-title\"><input ref={checkBoxRef} type=\"checkbox\" onChange={(e) => handleToggle(e)} />Reduction ratio</div>\r\n            <div ref={selectorRef} className=\"tanni-wizard-selector gensoku-selector\">\r\n                <table>\r\n                    <thead>\r\n                        <tr>\r\n                            <th>Input</th>\r\n                            <th></th>\r\n                            <th>Output</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        <tr>\r\n                            <td><input type=\"text\" readOnly value={input1} onChange={(e) => setInput1(e.currentTarget.value)}/></td>\r\n                            <td>  :  </td>\r\n                            <td><input type=\"text\" readOnly value={input2} onChange={(e) => setInput2(e.currentTarget.value)}/></td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n            <div className=\"tanni-wizard-buttons\">\r\n                <Button className=\"tanni-back\" variant=\"contained\" onClick={() => goBack()}>BACK</Button>\r\n                <Button className=\"tanni-next\" variant=\"contained\" onClick={() => goNext()}>NEXT</Button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport const WizardBunkaiEng = (props) => {\r\n    const params = props.params\r\n    const tkData = params.tannikannsannData\r\n    const jikuMainNum = params.history[0][1][0]-1\r\n    const mode = params.history[1][1]\r\n    let bunkaiText = \"\"\r\n    let bunkaiVar = 1\r\n    const [input, setInput] = useState(params.history.length === 5 ? params.history[4][1] : tkData[jikuMainNum].bunkai)\r\n\r\n    switch (mode) {\r\n        case \"インデックステーブル\":\r\n            bunkaiText = \"°\"\r\n            bunkaiVar = 360 / (params.history[3][1][1]/params.history[3][1][0])\r\n            break\r\n        default:\r\n            bunkaiText = \"mm\"\r\n            bunkaiVar = params.history[2][1] / (params.history[3][1][1]/params.history[3][1][0])\r\n            break\r\n    }\r\n\r\n    const getTanniValue = () => {\r\n        return (1/parseFloat(params.history[2][1])) * parseFloat(input) * (parseFloat(params.history[3][1][1])/parseFloat(params.history[3][1][0]))\r\n    }\r\n\r\n    const goOK = () => {\r\n        let tkTmp = [...tkData]\r\n        params.history[0][1].forEach(jikuNum => {\r\n            tkTmp[jikuNum-1] = {kikou:params.history[1][1],susumiryou:[params.history[2][1],params.history[2][2]],gensoku:params.history[3][1],bunkai:input,tanniValue:getTanniValue()}\r\n        })\r\n        params.setTannikannsannData(tkTmp)\r\n        params.setHistory([])\r\n        props.close()\r\n    }\r\n\r\n    const goBack = () => {\r\n        params.setWizardInput([\"gensoku\", 0])\r\n    }\r\n\r\n    const changeInput = (item) => {\r\n        setInput(item)\r\n        let tmp = [...params.history]\r\n        if (tmp.length < 5) {\r\n            tmp.push([\"bunkai\", item])\r\n        } else {\r\n            tmp[4] = [\"bunkai\", item]\r\n        }\r\n        params.setHistory(tmp)\r\n    }\r\n\r\n    // decimal point function\r\n    function roundTo(n, digits) {\r\n        var negative = false;\r\n        if (digits === undefined) {\r\n            digits = 0;\r\n        }\r\n        if (n < 0) {\r\n            negative = true;\r\n            n = n * -1;\r\n        }\r\n        var multiplicator = Math.pow(10, digits);\r\n        n = parseFloat((n * multiplicator).toFixed(11));\r\n        n = (Math.round(n) / multiplicator).toFixed(digits);\r\n        if (negative) {\r\n            n = (n * -1).toFixed(digits);\r\n        }\r\n        return n;\r\n    }\r\n\r\n    return (\r\n        <div className=\"tanni-wizard unselectable\">\r\n            <p className=\"tanni-wizard-title\">Minimum positioning unit</p>\r\n            <div className=\"tanni-wizard-selector tanni-bunkai\">\r\n                <div className=\"bunkai-1\">\r\n                    <p className=\"tanni-bunkai-text\">Resolution of motor: </p>\r\n                    <DropdownEng setItem={changeInput} defaultItem={input} itemArr={[300, 600, 1000, 1200, 2000, 3000, 5000, 6000, 10000, 12000]} />\r\n                    <p className=\"tanni-bunkai-text\">pulse/revolution</p>\r\n                </div>\r\n                <div className=\"bunkai-2\">\r\n                    <p className=\"tanni-bunkai-text\">Minimum positioning unit: <span>{roundTo(bunkaiVar/parseFloat(input) + Number.EPSILON, 5)}</span> {bunkaiText}</p>\r\n                </div>\r\n            </div>\r\n            <div className=\"tanni-wizard-buttons\">\r\n                <Button className=\"tanni-back\" variant=\"contained\" onClick={() => goBack()}>BACK</Button>\r\n                <Button className=\"tanni-ok\" variant=\"contained\" onClick={() => goOK()}>OK</Button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport const DropdownEng = (props) => {\r\n    const itemArr = props.itemArr\r\n    const setItem = props.setItem\r\n\r\n    const [selectedItem, setSelectedItem] = useState(props.defaultItem !== undefined ? props.defaultItem : itemArr[0])\r\n    const dropdownItems = useRef()\r\n    const selectedItemRef = useRef()\r\n\r\n    const dropdowns = () => {\r\n        return itemArr.map(item => {\r\n            return (\r\n                <div className=\"dropdown-item unselectable\" onClick={(e) => clickItem(e)} key={item}>{item}</div>\r\n            )\r\n        })\r\n    }\r\n\r\n    const showItems = () => {\r\n        dropdownItems.current.style.display = \"block\"\r\n    }\r\n    \r\n    const clickItem = (e) => {\r\n        setSelectedItem(e.target.innerText)\r\n        setItem(e.target.innerText)\r\n        dropdownItems.current.style.display = \"none\"\r\n    }\r\n\r\n\r\n    return (\r\n        <div className=\"dropdown-selector\">\r\n            <div ref={selectedItemRef} className=\"selected-item unselectable\" onClick={() => showItems()}>{selectedItem}<i className=\"fas fa-angle-down\"></i></div>\r\n            <div ref={dropdownItems} className=\"dropdown-items unselectable\">\r\n                {dropdowns()}\r\n            </div>\r\n        </div>\r\n    )\r\n}","import React, { useRef, useState } from 'react';\r\nimport { SettingsPanel } from '../settingsPanel/settingsPanel';\r\nimport { WizardGensokuEng, WizardKikouEng, WizardSusumiryouEng, WizardBunkaiEng, WizardJikuEng } from './tanni-funcs_eng';\r\nimport { toCML } from '../toCml';\r\nimport { Link } from \"react-router-dom\";\r\n\r\n// Function to download data to a file\r\nexport const downloadFile = (data, filename, type) => {\r\n    var file = new Blob([data], {type: type});\r\n    if (window.navigator.msSaveOrOpenBlob) // IE10+\r\n        window.navigator.msSaveOrOpenBlob(file, filename);\r\n    else { // Others\r\n        let a = document.createElement(\"a\"),\r\n        url = URL.createObjectURL(file);\r\n        a.href = url;\r\n        a.download = filename;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        setTimeout(function() {\r\n            document.body.removeChild(a);\r\n            window.URL.revokeObjectURL(url);  \r\n        }, 0); \r\n    }\r\n}\r\n\r\nexport const TopMenuEng = (props) => {\r\n\r\n    const topMenuRef = useRef()\r\n    const muteIconRef = useRef()\r\n\r\n    const handleFileImport = (e) => {\r\n        const reader = new FileReader()\r\n        reader.onload = async (e) => { \r\n            // const obj = JSON.parse(e.target.result)\r\n            const obj = JSON.parse(reader.result)\r\n            // try {\r\n                props.setJiku(obj.data.jiku)\r\n                props.setTannikannsannData(obj.data.tannikannsannData)\r\n                props.setProgramData(obj.data.programData)\r\n                props.setLoopData(obj.data.loopData)\r\n                props.setCmlOutput(toCML(obj.data.programData, obj.data.loopData, obj.data.isNyuryokuShingou, obj.data.tannikannsannData))\r\n            // } catch (err) {\r\n            //     alert('ファイルが間違っています')\r\n            // }\r\n        };\r\n        reader.readAsText(e.target.files[0], \"utf-8\")\r\n    }\r\n\r\n    // Function to download data to a file\r\n    const downloadFile = (data, filename, type) => {\r\n        var file = new Blob([data], {type: type});\r\n        if (window.navigator.msSaveOrOpenBlob) // IE10+\r\n            window.navigator.msSaveOrOpenBlob(file, filename);\r\n        else { // Others\r\n            var a = document.createElement(\"a\"),\r\n            url = URL.createObjectURL(file);\r\n            a.href = url;\r\n            a.download = filename;\r\n            document.body.appendChild(a);\r\n            a.click();\r\n            setTimeout(function() {\r\n                document.body.removeChild(a);\r\n                window.URL.revokeObjectURL(url);  \r\n            }, 0); \r\n        }\r\n    }\r\n\r\n    const handleFileSave = () => {\r\n        let obj = {\"name\":\"cml-import\",\"data\":{\"jiku\":props.jiku,\"tannikannsannData\":props.tannikannsannData,\"programData\":props.programData,\"loopData\":props.loopData,\"isNyuryokuShingou\":props.isNyuryokuShingou}}\r\n        const data = JSON.stringify(obj)\r\n        const filename = \"CML-途中保存\"\r\n        const type = \".txt\"\r\n        downloadFile(data, filename, type)\r\n    }\r\n\r\n    const display = (ref) => {\r\n        ref.current.classList.add(\"shown\")\r\n        ref.current.classList.remove(\"hidden\")\r\n        setTimeout(() => {\r\n            if (!ref.current.classList.contains(\"hidden\")) {\r\n                ref.current.style.display = \"block\"\r\n            }\r\n        }, 500)\r\n    }\r\n\r\n    const hide = (ref) => {\r\n        ref.current.classList.remove('shown')\r\n        ref.current.classList.add('hidden')\r\n        ref.current.style.display = \"none\"\r\n    }\r\n\r\n    const openTanni = () => {\r\n        topMenuRef.current.querySelector('.tannikannsann-popup').style.display = \"flex\"\r\n        props.layerRef.current.style.display = \"block\"\r\n    }\r\n\r\n    const closeTanni = (topMenuRef, layerRef) => {\r\n        topMenuRef.current.querySelector('.tannikannsann-popup').style.display = \"none\"\r\n        layerRef.current.style.display = \"none\"\r\n    }\r\n\r\n    const openSettingsPanel = () => {\r\n        topMenuRef.current.querySelector('#settings-panel').style.display = \"flex\"\r\n        props.layerRef.current.style.display = \"block\"\r\n    }\r\n\r\n    const closeSettingsPanel = () => {\r\n        topMenuRef.current.querySelector('#settings-panel').style.display = \"none\"\r\n        props.layerRef.current.style.display = \"none\"\r\n    }\r\n\r\n    const toggleIsMute = (e) => {\r\n        let isPressed = muteIconRef.current.classList.contains(\"fa-volume-xmark\")\r\n        if (isPressed) {\r\n            muteIconRef.current.classList.remove(\"fa-volume-xmark\")\r\n            muteIconRef.current.classList.add(\"fa-volume-high\")\r\n            props.setIsMute(false)\r\n        } else {\r\n            muteIconRef.current.classList.remove(\"fa-volume-high\")\r\n            muteIconRef.current.classList.add(\"fa-volume-xmark\")\r\n            props.setIsMute(true)\r\n        }\r\n    }\r\n\r\n    const muteIcon = props.isMute ? \"volume-xmark\" : \"volume-high\"\r\n    // --\r\n    const expSave = useRef() \r\n    const expImp = useRef() \r\n    const expTanni = useRef() \r\n\r\n    return (\r\n        <div ref={topMenuRef} className=\"top-menu\">\r\n            <div className=\"top-menu-button save-file unselectable\" onMouseEnter={() => display(expSave)} onMouseLeave={() => hide(expSave)} onClick={() => handleFileSave()}>\r\n                <i className=\"fa-solid fa-floppy-disk\"></i>Save project as\r\n                <div ref={expSave} className=\"exp-box hidden\">Save project in progress</div>\r\n            </div>\r\n            \r\n            <div className=\"top-menu-button import-file unselectable\" onMouseEnter={() => display(expImp)} onMouseLeave={() => hide(expImp)}>\r\n                <label htmlFor=\"top-menu-file-upload\">\r\n                    <i className=\"fa-solid fa-folder-open\"></i>Open project\r\n                    <input id=\"top-menu-file-upload\" accept=\".txt\" type=\"file\" onChange={(e) => handleFileImport(e)}/>\r\n                </label>\r\n                <div ref={expImp} className=\"exp-box hidden\">Open a saved project</div>\r\n            </div>\r\n            <div className=\"top-menu-button tannikannsann unselectable\" onMouseEnter={() => display(expTanni)} onMouseLeave={() => hide(expTanni)} onClick={() => openTanni()}>\r\n                <i className=\"fa-solid fa-gears\"></i>Unit conversion\r\n                <div ref={expTanni} className=\"exp-box hidden\">Sets units and resolution</div>\r\n            </div>\r\n            <Tannikannsann jiku={props.jiku} tannikannsannData={props.tannikannsannData} setTannikannsannData={props.setTannikannsannData} application={props.application} setApplication={props.setApplication} tanniValue={props.tanniValue} setTanniValue={props.setTanniValue} layerRef={props.layerRef} topMenuRef={topMenuRef} closeTanni={closeTanni}/>\r\n            <div className=\"top-menu-button settings unselectable\" onClick={() => openSettingsPanel()}>\r\n                <i className=\"fa-solid fa-gear\"></i>Settings\r\n            </div>\r\n            <SettingsPanel closePanel={closeSettingsPanel} />\r\n            <div className='top-menu-button mute-button unselectable' onClick={(e) => toggleIsMute(e)}>\r\n                <i ref={muteIconRef} className={\"fa-solid fa-\"+muteIcon}></i>\r\n            </div>\r\n            <Link to=\"/\">\r\n                <div className='top-menu-button language-button unselectable'>\r\n                    <i className={\"fa-solid fa-globe\"}></i>日本語\r\n                </div>\r\n            </Link>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst Tannikannsann = (props) => {\r\n    // props: tanniValue, setTanniValue, application, setApplication, tannikannsannData, setTannikannsannData\r\n    \r\n    const close = () => {\r\n        props.closeTanni(props.topMenuRef, props.layerRef)\r\n    }\r\n    \r\n    const WizardController = (props) => {\r\n        const [history, setHistory] = useState([])\r\n        const [wizardInput, setWizardInput] = useState([\"jiku\", []])\r\n\r\n        const inputForm = () => {\r\n            const params = {\r\n                wizardInput: wizardInput[1], \r\n                history, setHistory, setWizardInput,\r\n                tannikannsannData: props.tannikannsannData, setTannikannsannData: props.setTannikannsannData,\r\n                jiku: props.jiku\r\n            }\r\n        \r\n            switch (wizardInput[0]) {\r\n                case \"jiku\":\r\n                    return <WizardJikuEng params={params} />\r\n                case \"kikou\":\r\n                    return <WizardKikouEng params={params} />\r\n                case \"susumiryou\":\r\n                    return <WizardSusumiryouEng params={params} />\r\n                case \"gensoku\":\r\n                    return <WizardGensokuEng params={params} />\r\n                case \"bunkai\":\r\n                    return <WizardBunkaiEng close={props.close} params={params} />\r\n                default:\r\n                    return <WizardKikouEng params={params}/>\r\n            }\r\n        }\r\n\r\n        return (\r\n            <div className='wizard-controller'>\r\n                    {inputForm()}\r\n            </div>\r\n        )\r\n    } \r\n\r\n    return (\r\n        <div className=\"tannikannsann-popup\">\r\n            <div className=\"close-popup close-tannikannsann\" onClick={() => close()}><i className=\"fas fa-times-circle\"></i></div>\r\n            <WizardController close={close} jiku={props.jiku} tannikannsannData={props.tannikannsannData} setTannikannsannData={props.setTannikannsannData} />\r\n        </div>\r\n    )\r\n}\r\n","import { Button } from '@mui/material';\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport '../App.css'\r\nimport '../program-grid.css'\r\nimport { Editor } from '../Editor';\r\nimport { ProgramBlockEng, TypeDataInDousaEng, LoopInputBoxEng } from './programBlock_eng';\r\nimport useLocalStorage from '../useLocalStorage';\r\nimport { TopMenuEng } from './menu_eng';\r\nimport { downloadFile } from '../menu';\r\nimport soundfile1 from '../sounds/決定、ボタン押下38.mp3'\r\nimport soundfile2 from '../sounds/決定、ボタン押下44.mp3'\r\nimport instructionImg from '../image/popup-instruction.png'\r\n\r\nexport const AppEng = () => {\r\n\r\n    useEffect(() => {\r\n        document.title = 'Automatic CML Generation Tool | MUSCLE CORPORATION';\r\n      }, []);\r\n\r\n    const [cmlOutput, setCmlOutput] = useLocalStorage('CML', '')\r\n    const [isNyuryokuShingou, setIsNyuryokuShingou] = useState(false)\r\n    // const [isNyuryokuShingou, setIsNyuryokuShingou] = useLocalStorage(\"nyuryokushingou\", false)\r\n    const [isMute, setIsMute] = useState(false)\r\n    const [jiku, setJiku] = useState(1)\r\n    let initialTannikannsannData = []\r\n    for (let i=0; i < jiku; i++) {\r\n        initialTannikannsannData.push({kikou: \"initial\", susumiryou: [1,1], gensoku: [1,1], bunkai: 300, tanniValue:1})\r\n    }\r\n    const [tannikannsannData, setTannikannsannData] = useState(initialTannikannsannData)\r\n    // const [programData, setProgramData] = useState([[[[\"位置決め\", 1, [[100, \"pps\"], [100, \"pps\"], [100, \"pps\"]]],[],[]],[[],[],[]],[[],[],[]]]])\r\n    const [programData, setProgramData] = useState([[[[\"位置決め\", 1, [[100, \"pps\"], [100, \"pps\"], [100, \"pps\"]]]],[[]],[[]]]])\r\n    const [loopData, setLoopData] = useState([])\r\n    const [currentDraggedCommand, setCurrentDraggedCommand] = useState(\"位置決め\")\r\n\r\n    // typeDataObj: [jiku, parentId, dousaType, dousaNum, isInitial]\r\n    // loopInputObj: [parentId, isInitial]\r\n    const [typeDataObj, setTypeDataObj] = useState(new Array(5))\r\n    const [loopInputObj, setLoopInputObj] = useState(new Array(2))\r\n    const [inputBoxType, setInputBoxType] = useState(\"none\")\r\n\r\n    const typeDataRef = useRef()\r\n    const loopInputRef = useRef()\r\n    const expCopy = useRef()\r\n    const expCopyDone = useRef()\r\n    const layerRef = useRef()\r\n    const commandSelectorRef = useRef()\r\n    const instructionPopupRef = useRef()\r\n\r\n    // const getIndex = (document) => {\r\n    //     let res = document.id.split('-')\r\n    //     res.shift()\r\n    //     return res\r\n    // }\r\n\r\n    const commandDragStart = (e) => {\r\n        if (!isMute) {\r\n            let audio = new Audio(soundfile1);\r\n            audio.play();\r\n        }\r\n    }\r\n\r\n    const commandHover = (e) => {\r\n        switch(e.target.id) {\r\n            case \"ichigime-selector\":\r\n                setCurrentDraggedCommand(\"位置決め\")\r\n                break\r\n            case \"oshituke-selector\":\r\n                setCurrentDraggedCommand(\"押付け\")\r\n                break\r\n            case \"taima-selector\":\r\n                setCurrentDraggedCommand(\"タイマ\")\r\n                break\r\n            case \"incremental-ichigime-selector\":\r\n                setCurrentDraggedCommand(\"位置決め+\")\r\n                break\r\n            case \"incremental-oshituke-selector\":\r\n                setCurrentDraggedCommand(\"押付け+\")\r\n                break\r\n            case \"nyuryokuten-selector\":\r\n                setCurrentDraggedCommand(\"入力点からの実行\")\r\n                break\r\n            case \"kurikaeshi-selector\":\r\n                setCurrentDraggedCommand(\"繰り返し\")\r\n                break\r\n            case \"dousaGroup-selector\":\r\n                setCurrentDraggedCommand(\"動作グループを追加\")\r\n                break\r\n            default:\r\n                setCurrentDraggedCommand(\"NOPE\")\r\n                break\r\n        }\r\n        // this.className += ' hold';\r\n        // setTimeout(() => (this.className = 'invisible'), 0);\r\n    }\r\n    // function dragEnd() {\r\n    //     this.className = 'fill';\r\n    // }\r\n\r\n    const copyCML = (cml) => {\r\n        navigator.clipboard.writeText(cml);\r\n        expCopy.current.style.display = \"none\"\r\n        expCopyDone.current.style.display = \"block\"\r\n        setTimeout(() => {\r\n            expCopyDone.current.style.display = \"none\"\r\n        }, 2000)\r\n    }\r\n\r\n    const display = (ref) => {\r\n        ref.current.classList.add(\"shown\")\r\n        ref.current.classList.remove(\"hidden\")\r\n        setTimeout(() => {\r\n            if (!ref.current.classList.contains(\"hidden\")) {\r\n                ref.current.style.display = \"block\"\r\n            }\r\n        }, 500)\r\n    }\r\n\r\n    const hide = (ref) => {\r\n        ref.current.classList.remove('shown')\r\n        ref.current.classList.add('hidden')\r\n        ref.current.style.display = \"none\"\r\n    }\r\n\r\n    const showPopUpOfInstruction = () => {\r\n        instructionPopupRef.current.style.display = \"flex\"\r\n        handleFileExport()\r\n    }\r\n\r\n    const handleFileExport = () => {\r\n        const data = cmlOutput\r\n        const filename = \"CML-保存\"\r\n        const type = \".txt\"\r\n        downloadFile(data, filename, type)\r\n    }\r\n\r\n    const DataInputBox = (props) => {\r\n        switch (props.inputBoxType) {\r\n            case \"typedata\":\r\n                return <TypeDataInDousaEng tkData={tannikannsannData} setInputBoxType={setInputBoxType} isInitial={typeDataObj[4]} jiku={typeDataObj[0]} parentId={typeDataObj[1]} dousaType={typeDataObj[2]} dousaNum={typeDataObj[3]} programData={programData} setProgramData={setProgramData}/>\r\n            case \"loop\":\r\n                return <LoopInputBoxEng setInputBoxType={setInputBoxType} isInitial={loopInputObj[1]} parentId={loopInputObj[0]} loopData={loopData} setLoopData={setLoopData} />\r\n            default:\r\n                return <></>\r\n        }\r\n    }\r\n\r\n    const PopUpOfInstruction = () => {\r\n        const close = () => {\r\n            instructionPopupRef.current.style.display = \"none\"\r\n        }\r\n\r\n        return (\r\n            <div className='popup-instruction' ref={instructionPopupRef}>\r\n                <div className='popup-content'>\r\n                    <div id=\"close-instruction-popup\" onClick={() => close()}><i className=\"fas fa-times-circle\"></i></div>\r\n                    <img src={instructionImg} alt=\"instruction\" />\r\n                </div>\r\n                {/* <div className='popup-neveragain'>\r\n                    <p style={{marginRight:10}}>次回から表示しない</p>\r\n                    <input type={'checkbox'} />\r\n                </div> */}\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"main\">\r\n            <PopUpOfInstruction />\r\n            <DataInputBox inputBoxType={inputBoxType} />\r\n            <div ref={layerRef} className=\"layer\"></div>\r\n            <div className='top-menu-container'>\r\n                <TopMenuEng isMute={isMute} setIsMute={setIsMute} tannikannsannData={tannikannsannData} setTannikannsannData={setTannikannsannData} programData={programData} setProgramData={setProgramData} loopData={loopData} setLoopData={setLoopData} layerRef={layerRef} cmlOutput={cmlOutput} setCmlOutput={setCmlOutput} isNyuryokuShingou={isNyuryokuShingou} setIsNyuryokuShingou={setIsNyuryokuShingou} jiku={jiku} setJiku={setJiku}/>\r\n            </div>\r\n            <div className=\"center-section\">\r\n                <div className=\"command-list-width-box\"></div>\r\n                <div className='command-list-container'>\r\n                    <div className=\"command-list\">\r\n                        <div className='command-list-wrapper'>\r\n                            <div onMouseEnter={(e) => commandHover(e)} className=\"command-selector\" id=\"dousaGroup-selector\" draggable=\"true\"><i className=\"fas fa-grip-vertical\"></i>Add Motion Group</div>\r\n                            <div ref={commandSelectorRef} onDragStart={(e) => commandDragStart(e)} onMouseEnter={(e) => commandHover(e)} className=\"command-selector\" id=\"ichigime-selector\" draggable=\"true\"><i className=\"fas fa-grip-vertical\"></i>PTP</div>\r\n                            <div ref={commandSelectorRef} onDragStart={(e) => commandDragStart(e)} onMouseEnter={(e) => commandHover(e)} className=\"command-selector\" id=\"oshituke-selector\" draggable=\"true\"><i className=\"fas fa-grip-vertical\"></i>Push</div>\r\n                            <div ref={commandSelectorRef} onDragStart={(e) => commandDragStart(e)} onMouseEnter={(e) => commandHover(e)} className=\"command-selector\" id=\"taima-selector\" draggable=\"true\"><i className=\"fas fa-grip-vertical\"></i>Timer</div>\r\n                            <div ref={commandSelectorRef} onDragStart={(e) => commandDragStart(e)} onMouseEnter={(e) => commandHover(e)} className=\"command-selector\" id=\"kurikaeshi-selector\" draggable=\"true\"><i className=\"fas fa-grip-vertical\"></i>Loop</div>\r\n                            <div ref={commandSelectorRef} onDragStart={(e) => commandDragStart(e)} onMouseEnter={(e) => commandHover(e)} className=\"command-selector\" id=\"incremental-ichigime-selector\" draggable=\"true\"><i className=\"fas fa-grip-vertical\"></i>PTP+</div>\r\n                            <div ref={commandSelectorRef} onDragStart={(e) => commandDragStart(e)} onMouseEnter={(e) => commandHover(e)} className=\"command-selector\" id=\"incremental-oshituke-selector\" draggable=\"true\"><i className=\"fas fa-grip-vertical\"></i>Push+</div>\r\n                            <div ref={commandSelectorRef} onDragStart={(e) => commandDragStart(e)} onMouseEnter={(e) => commandHover(e)} className=\"command-selector\" id=\"nyuryokuten-selector\" draggable=\"true\"><i className=\"fas fa-grip-vertical\"></i>Execution from Input signal</div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div className='main-interface-section'>\r\n                    <div className='program-block-container'>\r\n                        <ProgramBlockEng isMute={isMute} tkData={tannikannsannData} setTkData={setTannikannsannData} setInputBoxType={setInputBoxType} inputBoxType={inputBoxType} loopInputObj={loopInputObj} setLoopInputObj={setLoopInputObj} typeDataObj={typeDataObj} setTypeDataObj={setTypeDataObj} typeDataRef={typeDataRef} loopInputRef={loopInputRef} isNyuryokuShingou={isNyuryokuShingou} setCmlOutput={setCmlOutput} loopData={loopData} setLoopData={setLoopData} programData={programData} setProgramData={setProgramData} jiku={jiku} setJiku={setJiku} currentDraggedCommand={currentDraggedCommand} setCurrentDraggedCommand={setCurrentDraggedCommand}/>\r\n                    </div>\r\n                    <div className='cml-output-container'>\r\n                        <div className=\"cml-output-section\">\r\n                            <h3 className='unselectable'>CML</h3>\r\n                            <Editor value={cmlOutput} onChange={setCmlOutput} />\r\n                            <div className=\"jikkou-button\">\r\n                                <Button variant=\"contained\" onClick={() => showPopUpOfInstruction()}>\r\n                                    Export<br/>text file\r\n                                </Button>\r\n                                <div className=\"copy-cml-container\">\r\n                                    <div className=\"copy-cml\" onMouseEnter={() => display(expCopy)} onMouseLeave={() => hide(expCopy)} onClick={() => copyCML(cmlOutput)}><i className=\"fas fa-copy\"></i></div>\r\n                                    <div ref={expCopy} className=\"exp-copy hidden\">copy</div>\r\n                                    <div ref={expCopyDone} className=\"exp-copy-done hidden\">copied!</div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            {/* <div className=\"center-section\">\r\n                <TopMenuEng tannikannsannData={tannikannsannData} setTannikannsannData={setTannikannsannData} programData={programData} setProgramData={setProgramData} loopData={loopData} setLoopData={setLoopData} layerRef={layerRef} cmlOutput={cmlOutput} setCmlOutput={setCmlOutput} isNyuryokuShingou={isNyuryokuShingou} setIsNyuryokuShingou={setIsNyuryokuShingou} jiku={jiku} setJiku={setJiku}/>\r\n                <ProgramBlockEng tkData={tannikannsannData} setInputBoxType={setInputBoxType} inputBoxType={inputBoxType} loopInputObj={loopInputObj} setLoopInputObj={setLoopInputObj} typeDataObj={typeDataObj} setTypeDataObj={setTypeDataObj} typeDataRef={typeDataRef} loopInputRef={loopInputRef} isNyuryokuShingou={isNyuryokuShingou} setCmlOutput={setCmlOutput} loopData={loopData} setLoopData={setLoopData} programData={programData} setProgramData={setProgramData} jiku={jiku} setJiku={setJiku} currentDraggedCommand={currentDraggedCommand} setCurrentDraggedCommand={setCurrentDraggedCommand}/>\r\n            </div>\r\n            <div className=\"cml-output-section\">\r\n                <h3 className='unselectable'>CML</h3>\r\n                <Editor value={cmlOutput} onChange={setCmlOutput} />\r\n                <div className=\"jikkou-button\">\r\n                    <Button variant=\"contained\" onClick={() => handleFileExport()}>\r\n                        テキストファイルにエクスポート\r\n                    </Button>\r\n                    <div className=\"copy-cml-container\">\r\n                        <div className=\"copy-cml\" onMouseEnter={() => display(expCopy)} onMouseLeave={() => hide(expCopy)} onClick={() => copyCML(cmlOutput)}><i className=\"fas fa-copy\"></i></div>\r\n                        <div ref={expCopy} className=\"exp-copy hidden\">コピー</div>\r\n                        <div ref={expCopyDone} className=\"exp-copy-done hidden\">コピーされました</div>\r\n                    </div>\r\n                </div>\r\n            </div> */}\r\n        </div>\r\n    )\r\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { App } from './App'\nimport {\n  BrowserRouter,\n  Routes, //replaces \"Switch\" used till v5\n  Route,\n} from \"react-router-dom\";\nimport { AppEng } from './eng/App_eng';\n\nconst AppWrapper = () => {\n  return (\n    <div className='App'>\n      <BrowserRouter basename='/cml-app'>\n        <Routes>\n          <Route path=\"/\" element={<App />} />\n          <Route path=\"/eng\" element={<AppEng />} />\n        </Routes>\n      </BrowserRouter>\n    </div>\n  )\n}\n\nReactDOM.render(\n  <React.StrictMode>\n    <AppWrapper />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}